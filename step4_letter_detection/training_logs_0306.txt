ileNotFoundError: [Errno 2] No such file or directory: './home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ds_gen/ann_test.csv'
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/train.py --batch-size=1 --lr=1e-4 --random-transform --compute-val-loss --steps=800 --weighted-average --snapshot-path ./snapshots csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ds_gen/ann_train.csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ds_gen/class_mapping.csv --val-annotations /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ds_gen/ann_test.csv
Using TensorFlow backend.
2019-06-03 12:01:07.985700: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 12:01:08.058809: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-06-03 12:01:08.059332: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x20192f0 executing computations on platform CUDA. Devices:
2019-06-03 12:01:08.059351: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce GTX 960M, Compute Capability 5.0
2019-06-03 12:01:08.080151: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 12:01:08.080998: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x26dd750 executing computations on platform Host. Devices:
2019-06-03 12:01:08.081028: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-06-03 12:01:08.081240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176
pciBusID: 0000:02:00.0
totalMemory: 3.95GiB freeMemory: 3.21GiB
2019-06-03 12:01:08.081257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2019-06-03 12:01:08.081983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-06-03 12:01:08.082000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2019-06-03 12:01:08.082006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2019-06-03 12:01:08.082134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2983 MB memory) -> physical GPU (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0, compute capability: 5.0)
Creating model, this may take a second...
WARNING:tensorflow:From /home/abert/.virtualenvs/test/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, None, None, 3 0                                            
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, None, None, 6 9408        input_1[0][0]                    
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, None, None, 6 256         conv1[0][0]                      
__________________________________________________________________________________________________
conv1_relu (Activation)         (None, None, None, 6 0           bn_conv1[0][0]                   
__________________________________________________________________________________________________
pool1 (MaxPooling2D)            (None, None, None, 6 0           conv1_relu[0][0]                 
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, None, None, 6 4096        pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, None, None, 6 256         res2a_branch2a[0][0]             
__________________________________________________________________________________________________
res2a_branch2a_relu (Activation (None, None, None, 6 0           bn2a_branch2a[0][0]              
__________________________________________________________________________________________________
padding2a_branch2b (ZeroPadding (None, None, None, 6 0           res2a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, None, None, 6 36864       padding2a_branch2b[0][0]         
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, None, None, 6 256         res2a_branch2b[0][0]             
__________________________________________________________________________________________________
res2a_branch2b_relu (Activation (None, None, None, 6 0           bn2a_branch2b[0][0]              
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, None, None, 2 16384       res2a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, None, None, 2 16384       pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, None, None, 2 1024        res2a_branch2c[0][0]             
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, None, None, 2 1024        res2a_branch1[0][0]              
__________________________________________________________________________________________________
res2a (Add)                     (None, None, None, 2 0           bn2a_branch2c[0][0]              
                                                                 bn2a_branch1[0][0]               
__________________________________________________________________________________________________
res2a_relu (Activation)         (None, None, None, 2 0           res2a[0][0]                      
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, None, None, 6 16384       res2a_relu[0][0]                 
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, None, None, 6 256         res2b_branch2a[0][0]             
__________________________________________________________________________________________________
res2b_branch2a_relu (Activation (None, None, None, 6 0           bn2b_branch2a[0][0]              
__________________________________________________________________________________________________
padding2b_branch2b (ZeroPadding (None, None, None, 6 0           res2b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, None, None, 6 36864       padding2b_branch2b[0][0]         
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, None, None, 6 256         res2b_branch2b[0][0]             
__________________________________________________________________________________________________
res2b_branch2b_relu (Activation (None, None, None, 6 0           bn2b_branch2b[0][0]              
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, None, None, 2 16384       res2b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, None, None, 2 1024        res2b_branch2c[0][0]             
__________________________________________________________________________________________________
res2b (Add)                     (None, None, None, 2 0           bn2b_branch2c[0][0]              
                                                                 res2a_relu[0][0]                 
__________________________________________________________________________________________________
res2b_relu (Activation)         (None, None, None, 2 0           res2b[0][0]                      
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, None, None, 6 16384       res2b_relu[0][0]                 
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, None, None, 6 256         res2c_branch2a[0][0]             
__________________________________________________________________________________________________
res2c_branch2a_relu (Activation (None, None, None, 6 0           bn2c_branch2a[0][0]              
__________________________________________________________________________________________________
padding2c_branch2b (ZeroPadding (None, None, None, 6 0           res2c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, None, None, 6 36864       padding2c_branch2b[0][0]         
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, None, None, 6 256         res2c_branch2b[0][0]             
__________________________________________________________________________________________________
res2c_branch2b_relu (Activation (None, None, None, 6 0           bn2c_branch2b[0][0]              
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, None, None, 2 16384       res2c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, None, None, 2 1024        res2c_branch2c[0][0]             
__________________________________________________________________________________________________
res2c (Add)                     (None, None, None, 2 0           bn2c_branch2c[0][0]              
                                                                 res2b_relu[0][0]                 
__________________________________________________________________________________________________
res2c_relu (Activation)         (None, None, None, 2 0           res2c[0][0]                      
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, None, None, 1 32768       res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, None, None, 1 512         res3a_branch2a[0][0]             
__________________________________________________________________________________________________
res3a_branch2a_relu (Activation (None, None, None, 1 0           bn3a_branch2a[0][0]              
__________________________________________________________________________________________________
padding3a_branch2b (ZeroPadding (None, None, None, 1 0           res3a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, None, None, 1 147456      padding3a_branch2b[0][0]         
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, None, None, 1 512         res3a_branch2b[0][0]             
__________________________________________________________________________________________________
res3a_branch2b_relu (Activation (None, None, None, 1 0           bn3a_branch2b[0][0]              
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, None, None, 5 65536       res3a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, None, None, 5 131072      res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, None, None, 5 2048        res3a_branch2c[0][0]             
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, None, None, 5 2048        res3a_branch1[0][0]              
__________________________________________________________________________________________________
res3a (Add)                     (None, None, None, 5 0           bn3a_branch2c[0][0]              
                                                                 bn3a_branch1[0][0]               
__________________________________________________________________________________________________
res3a_relu (Activation)         (None, None, None, 5 0           res3a[0][0]                      
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, None, None, 1 65536       res3a_relu[0][0]                 
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, None, None, 1 512         res3b_branch2a[0][0]             
__________________________________________________________________________________________________
res3b_branch2a_relu (Activation (None, None, None, 1 0           bn3b_branch2a[0][0]              
__________________________________________________________________________________________________
padding3b_branch2b (ZeroPadding (None, None, None, 1 0           res3b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, None, None, 1 147456      padding3b_branch2b[0][0]         
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, None, None, 1 512         res3b_branch2b[0][0]             
__________________________________________________________________________________________________
res3b_branch2b_relu (Activation (None, None, None, 1 0           bn3b_branch2b[0][0]              
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, None, None, 5 65536       res3b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, None, None, 5 2048        res3b_branch2c[0][0]             
__________________________________________________________________________________________________
res3b (Add)                     (None, None, None, 5 0           bn3b_branch2c[0][0]              
                                                                 res3a_relu[0][0]                 
__________________________________________________________________________________________________
res3b_relu (Activation)         (None, None, None, 5 0           res3b[0][0]                      
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, None, None, 1 65536       res3b_relu[0][0]                 
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, None, None, 1 512         res3c_branch2a[0][0]             
__________________________________________________________________________________________________
res3c_branch2a_relu (Activation (None, None, None, 1 0           bn3c_branch2a[0][0]              
__________________________________________________________________________________________________
padding3c_branch2b (ZeroPadding (None, None, None, 1 0           res3c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, None, None, 1 147456      padding3c_branch2b[0][0]         
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, None, None, 1 512         res3c_branch2b[0][0]             
__________________________________________________________________________________________________
res3c_branch2b_relu (Activation (None, None, None, 1 0           bn3c_branch2b[0][0]              
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, None, None, 5 65536       res3c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, None, None, 5 2048        res3c_branch2c[0][0]             
__________________________________________________________________________________________________
res3c (Add)                     (None, None, None, 5 0           bn3c_branch2c[0][0]              
                                                                 res3b_relu[0][0]                 
__________________________________________________________________________________________________
res3c_relu (Activation)         (None, None, None, 5 0           res3c[0][0]                      
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, None, None, 1 65536       res3c_relu[0][0]                 
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, None, None, 1 512         res3d_branch2a[0][0]             
__________________________________________________________________________________________________
res3d_branch2a_relu (Activation (None, None, None, 1 0           bn3d_branch2a[0][0]              
__________________________________________________________________________________________________
padding3d_branch2b (ZeroPadding (None, None, None, 1 0           res3d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, None, None, 1 147456      padding3d_branch2b[0][0]         
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, None, None, 1 512         res3d_branch2b[0][0]             
__________________________________________________________________________________________________
res3d_branch2b_relu (Activation (None, None, None, 1 0           bn3d_branch2b[0][0]              
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, None, None, 5 65536       res3d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, None, None, 5 2048        res3d_branch2c[0][0]             
__________________________________________________________________________________________________
res3d (Add)                     (None, None, None, 5 0           bn3d_branch2c[0][0]              
                                                                 res3c_relu[0][0]                 
__________________________________________________________________________________________________
res3d_relu (Activation)         (None, None, None, 5 0           res3d[0][0]                      
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, None, None, 2 131072      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, None, None, 2 1024        res4a_branch2a[0][0]             
__________________________________________________________________________________________________
res4a_branch2a_relu (Activation (None, None, None, 2 0           bn4a_branch2a[0][0]              
__________________________________________________________________________________________________
padding4a_branch2b (ZeroPadding (None, None, None, 2 0           res4a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, None, None, 2 589824      padding4a_branch2b[0][0]         
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, None, None, 2 1024        res4a_branch2b[0][0]             
__________________________________________________________________________________________________
res4a_branch2b_relu (Activation (None, None, None, 2 0           bn4a_branch2b[0][0]              
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, None, None, 1 262144      res4a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, None, None, 1 524288      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, None, None, 1 4096        res4a_branch2c[0][0]             
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, None, None, 1 4096        res4a_branch1[0][0]              
__________________________________________________________________________________________________
res4a (Add)                     (None, None, None, 1 0           bn4a_branch2c[0][0]              
                                                                 bn4a_branch1[0][0]               
__________________________________________________________________________________________________
res4a_relu (Activation)         (None, None, None, 1 0           res4a[0][0]                      
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, None, None, 2 262144      res4a_relu[0][0]                 
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, None, None, 2 1024        res4b_branch2a[0][0]             
__________________________________________________________________________________________________
res4b_branch2a_relu (Activation (None, None, None, 2 0           bn4b_branch2a[0][0]              
__________________________________________________________________________________________________
padding4b_branch2b (ZeroPadding (None, None, None, 2 0           res4b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, None, None, 2 589824      padding4b_branch2b[0][0]         
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, None, None, 2 1024        res4b_branch2b[0][0]             
__________________________________________________________________________________________________
res4b_branch2b_relu (Activation (None, None, None, 2 0           bn4b_branch2b[0][0]              
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, None, None, 1 262144      res4b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, None, None, 1 4096        res4b_branch2c[0][0]             
__________________________________________________________________________________________________
res4b (Add)                     (None, None, None, 1 0           bn4b_branch2c[0][0]              
                                                                 res4a_relu[0][0]                 
__________________________________________________________________________________________________
res4b_relu (Activation)         (None, None, None, 1 0           res4b[0][0]                      
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, None, None, 2 262144      res4b_relu[0][0]                 
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, None, None, 2 1024        res4c_branch2a[0][0]             
__________________________________________________________________________________________________
res4c_branch2a_relu (Activation (None, None, None, 2 0           bn4c_branch2a[0][0]              
__________________________________________________________________________________________________
padding4c_branch2b (ZeroPadding (None, None, None, 2 0           res4c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, None, None, 2 589824      padding4c_branch2b[0][0]         
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, None, None, 2 1024        res4c_branch2b[0][0]             
__________________________________________________________________________________________________
res4c_branch2b_relu (Activation (None, None, None, 2 0           bn4c_branch2b[0][0]              
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, None, None, 1 262144      res4c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, None, None, 1 4096        res4c_branch2c[0][0]             
__________________________________________________________________________________________________
res4c (Add)                     (None, None, None, 1 0           bn4c_branch2c[0][0]              
                                                                 res4b_relu[0][0]                 
__________________________________________________________________________________________________
res4c_relu (Activation)         (None, None, None, 1 0           res4c[0][0]                      
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, None, None, 2 262144      res4c_relu[0][0]                 
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, None, None, 2 1024        res4d_branch2a[0][0]             
__________________________________________________________________________________________________
res4d_branch2a_relu (Activation (None, None, None, 2 0           bn4d_branch2a[0][0]              
__________________________________________________________________________________________________
padding4d_branch2b (ZeroPadding (None, None, None, 2 0           res4d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, None, None, 2 589824      padding4d_branch2b[0][0]         
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, None, None, 2 1024        res4d_branch2b[0][0]             
__________________________________________________________________________________________________
res4d_branch2b_relu (Activation (None, None, None, 2 0           bn4d_branch2b[0][0]              
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, None, None, 1 262144      res4d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, None, None, 1 4096        res4d_branch2c[0][0]             
__________________________________________________________________________________________________
res4d (Add)                     (None, None, None, 1 0           bn4d_branch2c[0][0]              
                                                                 res4c_relu[0][0]                 
__________________________________________________________________________________________________
res4d_relu (Activation)         (None, None, None, 1 0           res4d[0][0]                      
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, None, None, 2 262144      res4d_relu[0][0]                 
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, None, None, 2 1024        res4e_branch2a[0][0]             
__________________________________________________________________________________________________
res4e_branch2a_relu (Activation (None, None, None, 2 0           bn4e_branch2a[0][0]              
__________________________________________________________________________________________________
padding4e_branch2b (ZeroPadding (None, None, None, 2 0           res4e_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, None, None, 2 589824      padding4e_branch2b[0][0]         
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, None, None, 2 1024        res4e_branch2b[0][0]             
__________________________________________________________________________________________________
res4e_branch2b_relu (Activation (None, None, None, 2 0           bn4e_branch2b[0][0]              
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, None, None, 1 262144      res4e_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, None, None, 1 4096        res4e_branch2c[0][0]             
__________________________________________________________________________________________________
res4e (Add)                     (None, None, None, 1 0           bn4e_branch2c[0][0]              
                                                                 res4d_relu[0][0]                 
__________________________________________________________________________________________________
res4e_relu (Activation)         (None, None, None, 1 0           res4e[0][0]                      
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, None, None, 2 262144      res4e_relu[0][0]                 
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, None, None, 2 1024        res4f_branch2a[0][0]             
__________________________________________________________________________________________________
res4f_branch2a_relu (Activation (None, None, None, 2 0           bn4f_branch2a[0][0]              
__________________________________________________________________________________________________
padding4f_branch2b (ZeroPadding (None, None, None, 2 0           res4f_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, None, None, 2 589824      padding4f_branch2b[0][0]         
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, None, None, 2 1024        res4f_branch2b[0][0]             
__________________________________________________________________________________________________
res4f_branch2b_relu (Activation (None, None, None, 2 0           bn4f_branch2b[0][0]              
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, None, None, 1 262144      res4f_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, None, None, 1 4096        res4f_branch2c[0][0]             
__________________________________________________________________________________________________
res4f (Add)                     (None, None, None, 1 0           bn4f_branch2c[0][0]              
                                                                 res4e_relu[0][0]                 
__________________________________________________________________________________________________
res4f_relu (Activation)         (None, None, None, 1 0           res4f[0][0]                      
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, None, None, 5 524288      res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, None, None, 5 2048        res5a_branch2a[0][0]             
__________________________________________________________________________________________________
res5a_branch2a_relu (Activation (None, None, None, 5 0           bn5a_branch2a[0][0]              
__________________________________________________________________________________________________
padding5a_branch2b (ZeroPadding (None, None, None, 5 0           res5a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5a_branch2b[0][0]         
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, None, None, 5 2048        res5a_branch2b[0][0]             
__________________________________________________________________________________________________
res5a_branch2b_relu (Activation (None, None, None, 5 0           bn5a_branch2b[0][0]              
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, None, None, 2 1048576     res5a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, None, None, 2 2097152     res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, None, None, 2 8192        res5a_branch2c[0][0]             
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, None, None, 2 8192        res5a_branch1[0][0]              
__________________________________________________________________________________________________
res5a (Add)                     (None, None, None, 2 0           bn5a_branch2c[0][0]              
                                                                 bn5a_branch1[0][0]               
__________________________________________________________________________________________________
res5a_relu (Activation)         (None, None, None, 2 0           res5a[0][0]                      
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, None, None, 5 1048576     res5a_relu[0][0]                 
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, None, None, 5 2048        res5b_branch2a[0][0]             
__________________________________________________________________________________________________
res5b_branch2a_relu (Activation (None, None, None, 5 0           bn5b_branch2a[0][0]              
__________________________________________________________________________________________________
padding5b_branch2b (ZeroPadding (None, None, None, 5 0           res5b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5b_branch2b[0][0]         
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, None, None, 5 2048        res5b_branch2b[0][0]             
__________________________________________________________________________________________________
res5b_branch2b_relu (Activation (None, None, None, 5 0           bn5b_branch2b[0][0]              
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, None, None, 2 1048576     res5b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, None, None, 2 8192        res5b_branch2c[0][0]             
__________________________________________________________________________________________________
res5b (Add)                     (None, None, None, 2 0           bn5b_branch2c[0][0]              
                                                                 res5a_relu[0][0]                 
__________________________________________________________________________________________________
res5b_relu (Activation)         (None, None, None, 2 0           res5b[0][0]                      
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, None, None, 5 1048576     res5b_relu[0][0]                 
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, None, None, 5 2048        res5c_branch2a[0][0]             
__________________________________________________________________________________________________
res5c_branch2a_relu (Activation (None, None, None, 5 0           bn5c_branch2a[0][0]              
__________________________________________________________________________________________________
padding5c_branch2b (ZeroPadding (None, None, None, 5 0           res5c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5c_branch2b[0][0]         
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, None, None, 5 2048        res5c_branch2b[0][0]             
__________________________________________________________________________________________________
res5c_branch2b_relu (Activation (None, None, None, 5 0           bn5c_branch2b[0][0]              
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, None, None, 2 1048576     res5c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, None, None, 2 8192        res5c_branch2c[0][0]             
__________________________________________________________________________________________________
res5c (Add)                     (None, None, None, 2 0           bn5c_branch2c[0][0]              
                                                                 res5b_relu[0][0]                 
__________________________________________________________________________________________________
res5c_relu (Activation)         (None, None, None, 2 0           res5c[0][0]                      
__________________________________________________________________________________________________
C5_reduced (Conv2D)             (None, None, None, 2 524544      res5c_relu[0][0]                 
__________________________________________________________________________________________________
P5_upsampled (UpsampleLike)     (None, None, None, 2 0           C5_reduced[0][0]                 
                                                                 res4f_relu[0][0]                 
__________________________________________________________________________________________________
C4_reduced (Conv2D)             (None, None, None, 2 262400      res4f_relu[0][0]                 
__________________________________________________________________________________________________
P4_merged (Add)                 (None, None, None, 2 0           P5_upsampled[0][0]               
                                                                 C4_reduced[0][0]                 
__________________________________________________________________________________________________
P4_upsampled (UpsampleLike)     (None, None, None, 2 0           P4_merged[0][0]                  
                                                                 res3d_relu[0][0]                 
__________________________________________________________________________________________________
C3_reduced (Conv2D)             (None, None, None, 2 131328      res3d_relu[0][0]                 
__________________________________________________________________________________________________
P6 (Conv2D)                     (None, None, None, 2 4718848     res5c_relu[0][0]                 
__________________________________________________________________________________________________
P3_merged (Add)                 (None, None, None, 2 0           P4_upsampled[0][0]               
                                                                 C3_reduced[0][0]                 
__________________________________________________________________________________________________
C6_relu (Activation)            (None, None, None, 2 0           P6[0][0]                         
__________________________________________________________________________________________________
P3 (Conv2D)                     (None, None, None, 2 590080      P3_merged[0][0]                  
__________________________________________________________________________________________________
P4 (Conv2D)                     (None, None, None, 2 590080      P4_merged[0][0]                  
__________________________________________________________________________________________________
P5 (Conv2D)                     (None, None, None, 2 590080      C5_reduced[0][0]                 
__________________________________________________________________________________________________
P7 (Conv2D)                     (None, None, None, 2 590080      C6_relu[0][0]                    
__________________________________________________________________________________________________
regression_submodel (Model)     (None, None, 4)      2443300     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
classification_submodel (Model) (None, None, 37)     3127885     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
regression (Concatenate)        (None, None, 4)      0           regression_submodel[1][0]        
                                                                 regression_submodel[2][0]        
                                                                 regression_submodel[3][0]        
                                                                 regression_submodel[4][0]        
                                                                 regression_submodel[5][0]        
__________________________________________________________________________________________________
classification (Concatenate)    (None, None, 37)     0           classification_submodel[1][0]    
                                                                 classification_submodel[2][0]    
                                                                 classification_submodel[3][0]    
                                                                 classification_submodel[4][0]    
                                                                 classification_submodel[5][0]    
==================================================================================================
Total params: 37,129,777
Trainable params: 37,023,537
Non-trainable params: 106,240
__________________________________________________________________________________________________
None
2019-06-03 12:01:19.736684: W tensorflow/core/framework/allocator.cc:124] Allocation of 18874368 exceeds 10% of system memory.
2019-06-03 12:01:19.785859: W tensorflow/core/framework/allocator.cc:124] Allocation of 18874368 exceeds 10% of system memory.
2019-06-03 12:01:19.822968: W tensorflow/core/framework/allocator.cc:124] Allocation of 18874368 exceeds 10% of system memory.
2019-06-03 12:01:19.841168: W tensorflow/core/framework/allocator.cc:124] Allocation of 18874368 exceeds 10% of system memory.
2019-06-03 12:01:19.906963: W tensorflow/core/framework/allocator.cc:124] Allocation of 18874368 exceeds 10% of system memory.
Epoch 1/50
2019-06-03 12:01:27.918014: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:27.955943: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:28.967149: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:29.085848: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:29.364988: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:29.497224: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:29.509948: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:29.513452: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:29.598251: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.13GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 12:01:29.732810: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
800/800 [==============================] - 1019s 1s/step - loss: 1.6176 - regression_loss: 1.0915 - classification_loss: 0.5262 - val_loss: 1.1790 - val_regression_loss: 0.8316 - val_classification_loss: 0.3474
Running network: N/A% (0 of 200) |                                                                                                                                     | Elapsed Time: 0:00:00 ETA:  --:--:--2019-06-03 12:18:22.563470: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_2. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 12:18:22.563526: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_3. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 12:18:22.563548: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_4. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 12:18:22.563596: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_5. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 12:18:23.023230: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_2. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 12:18:23.023279: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_3. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 12:18:23.023293: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_4. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 12:18:23.023306: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_5. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:13 Time:  0:01:13
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 0.9205
256 instances of class 1 with average precision: 0.8660
268 instances of class 2 with average precision: 0.3450
241 instances of class 3 with average precision: 0.4352
231 instances of class 4 with average precision: 0.5775
248 instances of class 5 with average precision: 0.2838
261 instances of class 6 with average precision: 0.2883
215 instances of class 7 with average precision: 0.5238
217 instances of class 8 with average precision: 0.5153
221 instances of class 9 with average precision: 0.2700
200 instances of class / with average precision: 1.0000
39 instances of class A with average precision: 0.1771
40 instances of class B with average precision: 0.2092
44 instances of class C with average precision: 0.0000
35 instances of class D with average precision: 0.2407
38 instances of class E with average precision: 0.0461
33 instances of class F with average precision: 0.0712
26 instances of class G with average precision: 0.2005
53 instances of class H with average precision: 0.1713
41 instances of class I with average precision: 0.0312
41 instances of class J with average precision: 0.0000
39 instances of class K with average precision: 0.1596
43 instances of class L with average precision: 0.0443
40 instances of class M with average precision: 0.4118
30 instances of class N with average precision: 0.2692
33 instances of class O with average precision: 0.1784
37 instances of class P with average precision: 0.0086
40 instances of class Q with average precision: 0.5329
33 instances of class R with average precision: 0.2620
38 instances of class S with average precision: 0.0912
38 instances of class T with average precision: 0.0000
45 instances of class U with average precision: 0.0018
45 instances of class V with average precision: 0.0948
38 instances of class W with average precision: 0.1843
41 instances of class X with average precision: 0.0000
37 instances of class Y with average precision: 0.0000
33 instances of class Z with average precision: 0.0000
mAP: 0.4256

Epoch 00001: saving model to ./snapshots/resnet50_csv_01.h5
Epoch 2/50
800/800 [==============================] - 1009s 1s/step - loss: 0.8922 - regression_loss: 0.6357 - classification_loss: 0.2565 - val_loss: 0.9749 - val_regression_loss: 0.7826 - val_classification_loss: 0.1923
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:23 Time:  0:01:23
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 1.0000
256 instances of class 1 with average precision: 0.9688
268 instances of class 2 with average precision: 1.0000
241 instances of class 3 with average precision: 0.9933
231 instances of class 4 with average precision: 0.9866
248 instances of class 5 with average precision: 0.9997
261 instances of class 6 with average precision: 0.5396
215 instances of class 7 with average precision: 0.9980
217 instances of class 8 with average precision: 1.0000
221 instances of class 9 with average precision: 0.5870
200 instances of class / with average precision: 0.9872
39 instances of class A with average precision: 0.9519
40 instances of class B with average precision: 0.9428
44 instances of class C with average precision: 0.5503
35 instances of class D with average precision: 0.9197
38 instances of class E with average precision: 0.3420
33 instances of class F with average precision: 0.1042
26 instances of class G with average precision: 0.2697
53 instances of class H with average precision: 0.9925
41 instances of class I with average precision: 0.2311
41 instances of class J with average precision: 0.2205
39 instances of class K with average precision: 0.7622
43 instances of class L with average precision: 0.2647
40 instances of class M with average precision: 0.3783
30 instances of class N with average precision: 0.6458
33 instances of class O with average precision: 0.5705
37 instances of class P with average precision: 0.3361
40 instances of class Q with average precision: 0.5458
33 instances of class R with average precision: 0.6747
38 instances of class S with average precision: 0.9974
38 instances of class T with average precision: 0.1857
45 instances of class U with average precision: 0.3983
45 instances of class V with average precision: 0.6515
38 instances of class W with average precision: 0.7884
41 instances of class X with average precision: 0.6725
37 instances of class Y with average precision: 0.4202
33 instances of class Z with average precision: 0.8719
mAP: 0.8177

Epoch 00002: saving model to ./snapshots/resnet50_csv_02.h5
Epoch 3/50
800/800 [==============================] - 1124s 1s/step - loss: 0.6627 - regression_loss: 0.5047 - classification_loss: 0.1579 - val_loss: 0.5163 - val_regression_loss: 0.3901 - val_classification_loss: 0.1262
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:20 Time:  0:01:20
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 1.0000
256 instances of class 1 with average precision: 0.9741
268 instances of class 2 with average precision: 1.0000
241 instances of class 3 with average precision: 0.9988
231 instances of class 4 with average precision: 1.0000
248 instances of class 5 with average precision: 1.0000
261 instances of class 6 with average precision: 0.5638
215 instances of class 7 with average precision: 1.0000
217 instances of class 8 with average precision: 1.0000
221 instances of class 9 with average precision: 0.4998
200 instances of class / with average precision: 1.0000
39 instances of class A with average precision: 1.0000
40 instances of class B with average precision: 0.9942
44 instances of class C with average precision: 0.8207
35 instances of class D with average precision: 0.9593
38 instances of class E with average precision: 0.7487
33 instances of class F with average precision: 0.8825
26 instances of class G with average precision: 0.6026
53 instances of class H with average precision: 1.0000
41 instances of class I with average precision: 0.1023
41 instances of class J with average precision: 0.8863
39 instances of class K with average precision: 0.9745
43 instances of class L with average precision: 0.8260
40 instances of class M with average precision: 0.7234
30 instances of class N with average precision: 0.9588
33 instances of class O with average precision: 0.5059
37 instances of class P with average precision: 0.9454
40 instances of class Q with average precision: 0.5931
33 instances of class R with average precision: 0.9844
38 instances of class S with average precision: 1.0000
38 instances of class T with average precision: 0.5077
45 instances of class U with average precision: 0.8770
45 instances of class V with average precision: 1.0000
38 instances of class W with average precision: 0.9993
41 instances of class X with average precision: 0.9503
37 instances of class Y with average precision: 0.8137
33 instances of class Z with average precision: 0.9413
mAP: 0.8897

Epoch 00003: saving model to ./snapshots/resnet50_csv_03.h5
Epoch 4/50
800/800 [==============================] - 1054s 1s/step - loss: 0.5571 - regression_loss: 0.4399 - classification_loss: 0.1172 - val_loss: 0.8468 - val_regression_loss: 0.7469 - val_classification_loss: 0.0999
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:12 Time:  0:01:12
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 1.0000
256 instances of class 1 with average precision: 0.9936
268 instances of class 2 with average precision: 1.0000
241 instances of class 3 with average precision: 1.0000
231 instances of class 4 with average precision: 1.0000
248 instances of class 5 with average precision: 1.0000
261 instances of class 6 with average precision: 0.5644
215 instances of class 7 with average precision: 1.0000
217 instances of class 8 with average precision: 1.0000
221 instances of class 9 with average precision: 0.6753
200 instances of class / with average precision: 1.0000
39 instances of class A with average precision: 1.0000
40 instances of class B with average precision: 0.9983
44 instances of class C with average precision: 0.9944
35 instances of class D with average precision: 1.0000
38 instances of class E with average precision: 0.9865
33 instances of class F with average precision: 0.9851
26 instances of class G with average precision: 0.9867
53 instances of class H with average precision: 1.0000
41 instances of class I with average precision: 0.7865
41 instances of class J with average precision: 0.9402
39 instances of class K with average precision: 0.9982
43 instances of class L with average precision: 1.0000
40 instances of class M with average precision: 0.9875
30 instances of class N with average precision: 1.0000
33 instances of class O with average precision: 0.4994
37 instances of class P with average precision: 0.9858
40 instances of class Q with average precision: 0.5971
33 instances of class R with average precision: 0.9991
38 instances of class S with average precision: 1.0000
38 instances of class T with average precision: 0.7937
45 instances of class U with average precision: 0.9802
45 instances of class V with average precision: 1.0000
38 instances of class W with average precision: 0.9993
41 instances of class X with average precision: 0.9884
37 instances of class Y with average precision: 0.9974
33 instances of class Z with average precision: 1.0000
mAP: 0.9325

Epoch 00004: saving model to ./snapshots/resnet50_csv_04.h5
Epoch 5/50
800/800 [==============================] - 1002s 1s/step - loss: 0.4344 - regression_loss: 0.3555 - classification_loss: 0.0789 - val_loss: 0.8312 - val_regression_loss: 0.7598 - val_classification_loss: 0.0714
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:12 Time:  0:01:12
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 1.0000
256 instances of class 1 with average precision: 0.9991
268 instances of class 2 with average precision: 1.0000
241 instances of class 3 with average precision: 1.0000
231 instances of class 4 with average precision: 0.9990
248 instances of class 5 with average precision: 1.0000
261 instances of class 6 with average precision: 0.6463
215 instances of class 7 with average precision: 1.0000
217 instances of class 8 with average precision: 1.0000
221 instances of class 9 with average precision: 0.4710
200 instances of class / with average precision: 1.0000
39 instances of class A with average precision: 1.0000
40 instances of class B with average precision: 1.0000
44 instances of class C with average precision: 0.9949
35 instances of class D with average precision: 1.0000
38 instances of class E with average precision: 0.9880
33 instances of class F with average precision: 1.0000
26 instances of class G with average precision: 0.9960
53 instances of class H with average precision: 1.0000
41 instances of class I with average precision: 0.8546
41 instances of class J with average precision: 1.0000
39 instances of class K with average precision: 1.0000
43 instances of class L with average precision: 1.0000
40 instances of class M with average precision: 0.9977
30 instances of class N with average precision: 1.0000
33 instances of class O with average precision: 0.5768
37 instances of class P with average precision: 1.0000
40 instances of class Q with average precision: 0.6089
33 instances of class R with average precision: 1.0000
38 instances of class S with average precision: 1.0000
38 instances of class T with average precision: 0.9993
45 instances of class U with average precision: 0.9981
45 instances of class V with average precision: 1.0000
38 instances of class W with average precision: 1.0000
41 instances of class X with average precision: 1.0000
37 instances of class Y with average precision: 1.0000
33 instances of class Z with average precision: 1.0000
mAP: 0.9316

Epoch 00005: saving model to ./snapshots/resnet50_csv_05.h5
Epoch 6/50
800/800 [==============================] - 1005s 1s/step - loss: 0.3611 - regression_loss: 0.2968 - classification_loss: 0.0643 - val_loss: 0.3532 - val_regression_loss: 0.2998 - val_classification_loss: 0.0534
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:12 Time:  0:01:12
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 1.0000
256 instances of class 1 with average precision: 0.9964
268 instances of class 2 with average precision: 1.0000
241 instances of class 3 with average precision: 1.0000
231 instances of class 4 with average precision: 1.0000
248 instances of class 5 with average precision: 1.0000
261 instances of class 6 with average precision: 0.9620
215 instances of class 7 with average precision: 1.0000
217 instances of class 8 with average precision: 1.0000
221 instances of class 9 with average precision: 0.8873
200 instances of class / with average precision: 1.0000
39 instances of class A with average precision: 1.0000
40 instances of class B with average precision: 1.0000
44 instances of class C with average precision: 1.0000
35 instances of class D with average precision: 1.0000
38 instances of class E with average precision: 1.0000
33 instances of class F with average precision: 1.0000
26 instances of class G with average precision: 1.0000
53 instances of class H with average precision: 1.0000
41 instances of class I with average precision: 0.9174
41 instances of class J with average precision: 1.0000
39 instances of class K with average precision: 1.0000
43 instances of class L with average precision: 1.0000
40 instances of class M with average precision: 0.9605
30 instances of class N with average precision: 1.0000
33 instances of class O with average precision: 0.6242
37 instances of class P with average precision: 1.0000
40 instances of class Q with average precision: 0.6882
33 instances of class R with average precision: 1.0000
38 instances of class S with average precision: 1.0000
38 instances of class T with average precision: 0.9922
45 instances of class U with average precision: 1.0000
45 instances of class V with average precision: 1.0000
38 instances of class W with average precision: 0.9959
41 instances of class X with average precision: 1.0000
37 instances of class Y with average precision: 1.0000
33 instances of class Z with average precision: 1.0000
mAP: 0.9817

Epoch 00006: saving model to ./snapshots/resnet50_csv_06.h5
Epoch 7/50
800/800 [==============================] - 1005s 1s/step - loss: 0.3374 - regression_loss: 0.2854 - classification_loss: 0.0520 - val_loss: 0.4740 - val_regression_loss: 0.4415 - val_classification_loss: 0.0325
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:11 Time:  0:01:11
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 1.0000
256 instances of class 1 with average precision: 0.9991
268 instances of class 2 with average precision: 1.0000
241 instances of class 3 with average precision: 1.0000
231 instances of class 4 with average precision: 1.0000
248 instances of class 5 with average precision: 1.0000
261 instances of class 6 with average precision: 0.9978
215 instances of class 7 with average precision: 1.0000
217 instances of class 8 with average precision: 1.0000
221 instances of class 9 with average precision: 1.0000
200 instances of class / with average precision: 1.0000
39 instances of class A with average precision: 1.0000
40 instances of class B with average precision: 1.0000
44 instances of class C with average precision: 1.0000
35 instances of class D with average precision: 1.0000
38 instances of class E with average precision: 0.9937
33 instances of class F with average precision: 1.0000
26 instances of class G with average precision: 1.0000
53 instances of class H with average precision: 1.0000
41 instances of class I with average precision: 0.8975
41 instances of class J with average precision: 1.0000
39 instances of class K with average precision: 1.0000
43 instances of class L with average precision: 1.0000
40 instances of class M with average precision: 1.0000
30 instances of class N with average precision: 1.0000
33 instances of class O with average precision: 0.7998
37 instances of class P with average precision: 1.0000
40 instances of class Q with average precision: 0.7828
33 instances of class R with average precision: 1.0000
38 instances of class S with average precision: 1.0000
38 instances of class T with average precision: 1.0000
45 instances of class U with average precision: 1.0000
45 instances of class V with average precision: 1.0000
38 instances of class W with average precision: 1.0000
41 instances of class X with average precision: 1.0000
37 instances of class Y with average precision: 1.0000
33 instances of class Z with average precision: 1.0000
mAP: 0.9943

Epoch 00007: saving model to ./snapshots/resnet50_csv_07.h5
Epoch 8/50
800/800 [==============================] - 1005s 1s/step - loss: 0.2832 - regression_loss: 0.2457 - classification_loss: 0.0375 - val_loss: 0.4180 - val_regression_loss: 0.3674 - val_classification_loss: 0.0506
Running network: 100% (200 of 200) |###################################################################################################################################| Elapsed Time: 0:01:12 Time:  0:01:12
Parsing annotations: 100% (200 of 200) |###############################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
242 instances of class 0 with average precision: 1.0000
256 instances of class 1 with average precision: 0.9972
268 instances of class 2 with average precision: 1.0000
241 instances of class 3 with average precision: 1.0000
231 instances of class 4 with average precision: 1.0000
248 instances of class 5 with average precision: 1.0000
261 instances of class 6 with average precision: 0.9846
215 instances of class 7 with average precision: 1.0000
217 instances of class 8 with average precision: 1.0000
221 instances of class 9 with average precision: 0.9725
200 instances of class / with average precision: 1.0000
39 instances of class A with average precision: 1.0000
40 instances of class B with average precision: 1.0000
44 instances of class C with average precision: 1.0000
35 instances of class D with average precision: 1.0000
38 instances of class E with average precision: 1.0000
33 instances of class F with average precision: 1.0000
26 instances of class G with average precision: 1.0000
53 instances of class H with average precision: 1.0000
41 instances of class I with average precision: 0.9439
41 instances of class J with average precision: 1.0000
39 instances of class K with average precision: 1.0000
43 instances of class L with average precision: 1.0000
40 instances of class M with average precision: 0.9742
30 instances of class N with average precision: 1.0000
33 instances of class O with average precision: 0.6915
37 instances of class P with average precision: 1.0000
40 instances of class Q with average precision: 0.9195
33 instances of class R with average precision: 1.0000
38 instances of class S with average precision: 1.0000
38 instances of class T with average precision: 1.0000
45 instances of class U with average precision: 1.0000
45 instances of class V with average precision: 1.0000
38 instances of class W with average precision: 1.0000
41 instances of class X with average precision: 1.0000
37 instances of class Y with average precision: 1.0000
33 instances of class Z with average precision: 1.0000
mAP: 0.9923

Epoch 00008: saving model to ./snapshots/resnet50_csv_08.h5
Epoch 9/50
178/800 [=====>........................] - ETA: 12:14 - loss: 0.2613 - regression_loss: 0.2284 - classification_loss: 0.0329^CProcess ForkPoolWorker-17:
Process ForkPoolWorker-18:
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
KeyboardInterrupt
^C^CProcess ForkPoolWorker-20:
Process ForkPoolWorker-19:
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
^CProcess ForkPoolWorker-21:
Traceback (most recent call last):
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training_generator.py", line 217, in fit_generator
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/usr/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
    class_weight=class_weight)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training.py", line 1217, in train_on_batch
    outputs = self.train_function(ins)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2715, in __call__
    return self._call(inputs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2675, in _call
    fetched = self._callable_fn(*array_vals)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1439, in __call__
    run_metadata_ptr)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "keras_retinanet/bin/train.py", line 514, in <module>
    main()
  File "keras_retinanet/bin/train.py", line 509, in main
    validation_data=validation_generator
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training.py", line 1418, in fit_generator
    initial_epoch=initial_epoch)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training_generator.py", line 262, in fit_generator
    val_enqueuer.stop()
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/data_utils.py", line 496, in stop
    self.run_thread.join(timeout)
  File "/usr/lib/python3.6/threading.py", line 1056, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.6/threading.py", line 1072, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
^C^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/convert_model.py /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/modelstraining/resnet50_csv_08.h5 /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/modelstraining/resnet50_csv_08_inf.h5
Using TensorFlow backend.
2019-06-03 14:36:18.743184: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 14:36:18.757993: E tensorflow/stream_executor/cuda/cuda_driver.cc:300] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2019-06-03 14:36:18.758029: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:161] retrieving CUDA diagnostic information for host: rusty
2019-06-03 14:36:18.758042: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:168] hostname: rusty
2019-06-03 14:36:18.758081: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:192] libcuda reported version is: 410.48.0
2019-06-03 14:36:18.758107: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:196] kernel reported version is: 410.48.0
2019-06-03 14:36:18.758114: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:303] kernel version seems to match DSO: 410.48.0
2019-06-03 14:36:18.788289: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 14:36:18.789299: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2230490 executing computations on platform Host. Devices:
2019-06-03 14:36:18.789331: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Traceback (most recent call last):
  File "keras_retinanet/bin/convert_model.py", line 88, in <module>
    main()
  File "keras_retinanet/bin/convert_model.py", line 75, in main
    model = models.load_model(args.model_in, backbone_name=args.backbone)
  File "keras_retinanet/bin/../../keras_retinanet/models/__init__.py", line 83, in load_model
    return keras.models.load_model(filepath, custom_objects=backbone(backbone_name).custom_objects)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/saving.py", line 417, in load_model
    f = h5dict(filepath, 'r')
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/io_utils.py", line 186, in __init__
    self.data = h5py.File(path, mode=mode)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/files.py", line 394, in __init__
    swmr=swmr)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/files.py", line 170, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 85, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = '/home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/modelstraining/resnet50_csv_08.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/convert_model.py /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/modelstraining/resnet50_csv_08.h5 /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/modelstraining/resnet50_csv_08_inf.h5
Using TensorFlow backend.
2019-06-03 14:36:53.809398: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 14:36:53.816333: E tensorflow/stream_executor/cuda/cuda_driver.cc:300] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2019-06-03 14:36:53.816363: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:161] retrieving CUDA diagnostic information for host: rusty
2019-06-03 14:36:53.816370: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:168] hostname: rusty
2019-06-03 14:36:53.816399: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:192] libcuda reported version is: 410.48.0
2019-06-03 14:36:53.816434: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:196] kernel reported version is: 410.48.0
2019-06-03 14:36:53.816442: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:303] kernel version seems to match DSO: 410.48.0
2019-06-03 14:36:53.836150: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 14:36:53.836755: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x190c490 executing computations on platform Host. Devices:
2019-06-03 14:36:53.836787: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Traceback (most recent call last):
  File "keras_retinanet/bin/convert_model.py", line 88, in <module>
    main()
  File "keras_retinanet/bin/convert_model.py", line 75, in main
    model = models.load_model(args.model_in, backbone_name=args.backbone)
  File "keras_retinanet/bin/../../keras_retinanet/models/__init__.py", line 83, in load_model
    return keras.models.load_model(filepath, custom_objects=backbone(backbone_name).custom_objects)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/saving.py", line 417, in load_model
    f = h5dict(filepath, 'r')
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/io_utils.py", line 186, in __init__
    self.data = h5py.File(path, mode=mode)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/files.py", line 394, in __init__
    swmr=swmr)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/files.py", line 170, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 85, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = '/home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/modelstraining/resnet50_csv_08.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/convert_model.py /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/models/resnet50_csv_08.h5 /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/models/resnet50_csv_08_inf.h5
Using TensorFlow backend.
2019-06-03 14:37:18.784728: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 14:37:18.791266: E tensorflow/stream_executor/cuda/cuda_driver.cc:300] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2019-06-03 14:37:18.791300: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:161] retrieving CUDA diagnostic information for host: rusty
2019-06-03 14:37:18.791309: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:168] hostname: rusty
2019-06-03 14:37:18.791349: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:192] libcuda reported version is: 410.48.0
2019-06-03 14:37:18.791377: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:196] kernel reported version is: 410.48.0
2019-06-03 14:37:18.791385: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:303] kernel version seems to match DSO: 410.48.0
2019-06-03 14:37:18.812006: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 14:37:18.812768: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x24f1450 executing computations on platform Host. Devices:
2019-06-03 14:37:18.812787: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
WARNING:tensorflow:From /home/abert/.virtualenvs/test/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/train.py --batch-size=1 --lr=1e-4 --random-transform --snapshot --compute-val-loss --steps=800 --weighted-average --snapshot-path ./snapshots csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ds_gen/ann_train.csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ds_gen/class_mapping.csv --val-annotations /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ds_gen/ann_test.csv
Using TensorFlow backend.
usage: train.py [-h]
                [--snapshot SNAPSHOT | --imagenet-weights | --weights WEIGHTS | --no-weights]
                [--backbone BACKBONE] [--batch-size BATCH_SIZE] [--gpu GPU]
                [--multi-gpu MULTI_GPU] [--multi-gpu-force] [--epochs EPOCHS]
                [--steps STEPS] [--lr LR] [--snapshot-path SNAPSHOT_PATH]
                [--tensorboard-dir TENSORBOARD_DIR] [--no-snapshots]
                [--no-evaluation] [--freeze-backbone] [--random-transform]
                [--image-min-side IMAGE_MIN_SIDE]
                [--image-max-side IMAGE_MAX_SIDE] [--config CONFIG]
                [--weighted-average] [--compute-val-loss] [--workers WORKERS]
                [--max-queue-size MAX_QUEUE_SIZE]
                {coco,pascal,kitti,oid,csv} ...
train.py: error: argument --snapshot: expected one argument
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/train.py --batch-size=1 --lr=1e-4 --random-transform --compute-val-loss --steps=800 --weighted-average --snapshot resnet50_csv_08.h5 --snapshot-path ./snapshots csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_train.csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/class_mapping.csv --val-annotations /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_val.csv
Using TensorFlow backend.
2019-06-03 15:25:52.020492: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 15:25:52.095415: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-06-03 15:25:52.095996: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x1ead350 executing computations on platform CUDA. Devices:
2019-06-03 15:25:52.096034: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce GTX 960M, Compute Capability 5.0
2019-06-03 15:25:52.116154: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 15:25:52.116676: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x25716b0 executing computations on platform Host. Devices:
2019-06-03 15:25:52.116710: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-06-03 15:25:52.116913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176
pciBusID: 0000:02:00.0
totalMemory: 3.95GiB freeMemory: 3.20GiB
2019-06-03 15:25:52.116934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2019-06-03 15:25:52.117741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-06-03 15:25:52.117767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2019-06-03 15:25:52.117776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2019-06-03 15:25:52.117896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2977 MB memory) -> physical GPU (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0, compute capability: 5.0)
Loading model, this may take a second...
Traceback (most recent call last):
  File "keras_retinanet/bin/train.py", line 514, in <module>
    main()
  File "keras_retinanet/bin/train.py", line 449, in main
    model            = models.load_model(args.snapshot, backbone_name=args.backbone)
  File "keras_retinanet/bin/../../keras_retinanet/models/__init__.py", line 83, in load_model
    return keras.models.load_model(filepath, custom_objects=backbone(backbone_name).custom_objects)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/saving.py", line 417, in load_model
    f = h5dict(filepath, 'r')
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/io_utils.py", line 186, in __init__
    self.data = h5py.File(path, mode=mode)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/files.py", line 394, in __init__
    swmr=swmr)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/files.py", line 170, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 85, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = 'resnet50_csv_08.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/train.py --batch-size=1 --lr=1e-4 --random-transform --compute-val-loss --steps=800 --weighted-average --snapshot ./snapshots/resnet50_csv_08.h5 --snapshot-path ./snapshots csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_train.csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/class_mapping.csv --val-annotations /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_val.csv
Using TensorFlow backend.
2019-06-03 15:26:18.614890: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 15:26:18.675508: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-06-03 15:26:18.675985: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x13f7380 executing computations on platform CUDA. Devices:
2019-06-03 15:26:18.676000: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce GTX 960M, Compute Capability 5.0
2019-06-03 15:26:18.696106: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 15:26:18.697150: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x1abb6e0 executing computations on platform Host. Devices:
2019-06-03 15:26:18.697184: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-06-03 15:26:18.697416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176
pciBusID: 0000:02:00.0
totalMemory: 3.95GiB freeMemory: 3.20GiB
2019-06-03 15:26:18.697446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2019-06-03 15:26:18.698414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-06-03 15:26:18.698432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2019-06-03 15:26:18.698440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2019-06-03 15:26:18.698587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2977 MB memory) -> physical GPU (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0, compute capability: 5.0)
Loading model, this may take a second...
WARNING:tensorflow:From /home/abert/.virtualenvs/test/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, None, None, 3 0                                            
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, None, None, 6 9408        input_1[0][0]                    
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, None, None, 6 256         conv1[0][0]                      
__________________________________________________________________________________________________
conv1_relu (Activation)         (None, None, None, 6 0           bn_conv1[0][0]                   
__________________________________________________________________________________________________
pool1 (MaxPooling2D)            (None, None, None, 6 0           conv1_relu[0][0]                 
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, None, None, 6 4096        pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, None, None, 6 256         res2a_branch2a[0][0]             
__________________________________________________________________________________________________
res2a_branch2a_relu (Activation (None, None, None, 6 0           bn2a_branch2a[0][0]              
__________________________________________________________________________________________________
padding2a_branch2b (ZeroPadding (None, None, None, 6 0           res2a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, None, None, 6 36864       padding2a_branch2b[0][0]         
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, None, None, 6 256         res2a_branch2b[0][0]             
__________________________________________________________________________________________________
res2a_branch2b_relu (Activation (None, None, None, 6 0           bn2a_branch2b[0][0]              
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, None, None, 2 16384       res2a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, None, None, 2 16384       pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, None, None, 2 1024        res2a_branch2c[0][0]             
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, None, None, 2 1024        res2a_branch1[0][0]              
__________________________________________________________________________________________________
res2a (Add)                     (None, None, None, 2 0           bn2a_branch2c[0][0]              
                                                                 bn2a_branch1[0][0]               
__________________________________________________________________________________________________
res2a_relu (Activation)         (None, None, None, 2 0           res2a[0][0]                      
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, None, None, 6 16384       res2a_relu[0][0]                 
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, None, None, 6 256         res2b_branch2a[0][0]             
__________________________________________________________________________________________________
res2b_branch2a_relu (Activation (None, None, None, 6 0           bn2b_branch2a[0][0]              
__________________________________________________________________________________________________
padding2b_branch2b (ZeroPadding (None, None, None, 6 0           res2b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, None, None, 6 36864       padding2b_branch2b[0][0]         
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, None, None, 6 256         res2b_branch2b[0][0]             
__________________________________________________________________________________________________
res2b_branch2b_relu (Activation (None, None, None, 6 0           bn2b_branch2b[0][0]              
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, None, None, 2 16384       res2b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, None, None, 2 1024        res2b_branch2c[0][0]             
__________________________________________________________________________________________________
res2b (Add)                     (None, None, None, 2 0           bn2b_branch2c[0][0]              
                                                                 res2a_relu[0][0]                 
__________________________________________________________________________________________________
res2b_relu (Activation)         (None, None, None, 2 0           res2b[0][0]                      
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, None, None, 6 16384       res2b_relu[0][0]                 
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, None, None, 6 256         res2c_branch2a[0][0]             
__________________________________________________________________________________________________
res2c_branch2a_relu (Activation (None, None, None, 6 0           bn2c_branch2a[0][0]              
__________________________________________________________________________________________________
padding2c_branch2b (ZeroPadding (None, None, None, 6 0           res2c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, None, None, 6 36864       padding2c_branch2b[0][0]         
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, None, None, 6 256         res2c_branch2b[0][0]             
__________________________________________________________________________________________________
res2c_branch2b_relu (Activation (None, None, None, 6 0           bn2c_branch2b[0][0]              
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, None, None, 2 16384       res2c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, None, None, 2 1024        res2c_branch2c[0][0]             
__________________________________________________________________________________________________
res2c (Add)                     (None, None, None, 2 0           bn2c_branch2c[0][0]              
                                                                 res2b_relu[0][0]                 
__________________________________________________________________________________________________
res2c_relu (Activation)         (None, None, None, 2 0           res2c[0][0]                      
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, None, None, 1 32768       res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, None, None, 1 512         res3a_branch2a[0][0]             
__________________________________________________________________________________________________
res3a_branch2a_relu (Activation (None, None, None, 1 0           bn3a_branch2a[0][0]              
__________________________________________________________________________________________________
padding3a_branch2b (ZeroPadding (None, None, None, 1 0           res3a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, None, None, 1 147456      padding3a_branch2b[0][0]         
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, None, None, 1 512         res3a_branch2b[0][0]             
__________________________________________________________________________________________________
res3a_branch2b_relu (Activation (None, None, None, 1 0           bn3a_branch2b[0][0]              
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, None, None, 5 65536       res3a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, None, None, 5 131072      res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, None, None, 5 2048        res3a_branch2c[0][0]             
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, None, None, 5 2048        res3a_branch1[0][0]              
__________________________________________________________________________________________________
res3a (Add)                     (None, None, None, 5 0           bn3a_branch2c[0][0]              
                                                                 bn3a_branch1[0][0]               
__________________________________________________________________________________________________
res3a_relu (Activation)         (None, None, None, 5 0           res3a[0][0]                      
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, None, None, 1 65536       res3a_relu[0][0]                 
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, None, None, 1 512         res3b_branch2a[0][0]             
__________________________________________________________________________________________________
res3b_branch2a_relu (Activation (None, None, None, 1 0           bn3b_branch2a[0][0]              
__________________________________________________________________________________________________
padding3b_branch2b (ZeroPadding (None, None, None, 1 0           res3b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, None, None, 1 147456      padding3b_branch2b[0][0]         
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, None, None, 1 512         res3b_branch2b[0][0]             
__________________________________________________________________________________________________
res3b_branch2b_relu (Activation (None, None, None, 1 0           bn3b_branch2b[0][0]              
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, None, None, 5 65536       res3b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, None, None, 5 2048        res3b_branch2c[0][0]             
__________________________________________________________________________________________________
res3b (Add)                     (None, None, None, 5 0           bn3b_branch2c[0][0]              
                                                                 res3a_relu[0][0]                 
__________________________________________________________________________________________________
res3b_relu (Activation)         (None, None, None, 5 0           res3b[0][0]                      
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, None, None, 1 65536       res3b_relu[0][0]                 
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, None, None, 1 512         res3c_branch2a[0][0]             
__________________________________________________________________________________________________
res3c_branch2a_relu (Activation (None, None, None, 1 0           bn3c_branch2a[0][0]              
__________________________________________________________________________________________________
padding3c_branch2b (ZeroPadding (None, None, None, 1 0           res3c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, None, None, 1 147456      padding3c_branch2b[0][0]         
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, None, None, 1 512         res3c_branch2b[0][0]             
__________________________________________________________________________________________________
res3c_branch2b_relu (Activation (None, None, None, 1 0           bn3c_branch2b[0][0]              
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, None, None, 5 65536       res3c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, None, None, 5 2048        res3c_branch2c[0][0]             
__________________________________________________________________________________________________
res3c (Add)                     (None, None, None, 5 0           bn3c_branch2c[0][0]              
                                                                 res3b_relu[0][0]                 
__________________________________________________________________________________________________
res3c_relu (Activation)         (None, None, None, 5 0           res3c[0][0]                      
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, None, None, 1 65536       res3c_relu[0][0]                 
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, None, None, 1 512         res3d_branch2a[0][0]             
__________________________________________________________________________________________________
res3d_branch2a_relu (Activation (None, None, None, 1 0           bn3d_branch2a[0][0]              
__________________________________________________________________________________________________
padding3d_branch2b (ZeroPadding (None, None, None, 1 0           res3d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, None, None, 1 147456      padding3d_branch2b[0][0]         
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, None, None, 1 512         res3d_branch2b[0][0]             
__________________________________________________________________________________________________
res3d_branch2b_relu (Activation (None, None, None, 1 0           bn3d_branch2b[0][0]              
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, None, None, 5 65536       res3d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, None, None, 5 2048        res3d_branch2c[0][0]             
__________________________________________________________________________________________________
res3d (Add)                     (None, None, None, 5 0           bn3d_branch2c[0][0]              
                                                                 res3c_relu[0][0]                 
__________________________________________________________________________________________________
res3d_relu (Activation)         (None, None, None, 5 0           res3d[0][0]                      
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, None, None, 2 131072      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, None, None, 2 1024        res4a_branch2a[0][0]             
__________________________________________________________________________________________________
res4a_branch2a_relu (Activation (None, None, None, 2 0           bn4a_branch2a[0][0]              
__________________________________________________________________________________________________
padding4a_branch2b (ZeroPadding (None, None, None, 2 0           res4a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, None, None, 2 589824      padding4a_branch2b[0][0]         
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, None, None, 2 1024        res4a_branch2b[0][0]             
__________________________________________________________________________________________________
res4a_branch2b_relu (Activation (None, None, None, 2 0           bn4a_branch2b[0][0]              
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, None, None, 1 262144      res4a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, None, None, 1 524288      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, None, None, 1 4096        res4a_branch2c[0][0]             
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, None, None, 1 4096        res4a_branch1[0][0]              
__________________________________________________________________________________________________
res4a (Add)                     (None, None, None, 1 0           bn4a_branch2c[0][0]              
                                                                 bn4a_branch1[0][0]               
__________________________________________________________________________________________________
res4a_relu (Activation)         (None, None, None, 1 0           res4a[0][0]                      
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, None, None, 2 262144      res4a_relu[0][0]                 
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, None, None, 2 1024        res4b_branch2a[0][0]             
__________________________________________________________________________________________________
res4b_branch2a_relu (Activation (None, None, None, 2 0           bn4b_branch2a[0][0]              
__________________________________________________________________________________________________
padding4b_branch2b (ZeroPadding (None, None, None, 2 0           res4b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, None, None, 2 589824      padding4b_branch2b[0][0]         
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, None, None, 2 1024        res4b_branch2b[0][0]             
__________________________________________________________________________________________________
res4b_branch2b_relu (Activation (None, None, None, 2 0           bn4b_branch2b[0][0]              
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, None, None, 1 262144      res4b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, None, None, 1 4096        res4b_branch2c[0][0]             
__________________________________________________________________________________________________
res4b (Add)                     (None, None, None, 1 0           bn4b_branch2c[0][0]              
                                                                 res4a_relu[0][0]                 
__________________________________________________________________________________________________
res4b_relu (Activation)         (None, None, None, 1 0           res4b[0][0]                      
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, None, None, 2 262144      res4b_relu[0][0]                 
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, None, None, 2 1024        res4c_branch2a[0][0]             
__________________________________________________________________________________________________
res4c_branch2a_relu (Activation (None, None, None, 2 0           bn4c_branch2a[0][0]              
__________________________________________________________________________________________________
padding4c_branch2b (ZeroPadding (None, None, None, 2 0           res4c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, None, None, 2 589824      padding4c_branch2b[0][0]         
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, None, None, 2 1024        res4c_branch2b[0][0]             
__________________________________________________________________________________________________
res4c_branch2b_relu (Activation (None, None, None, 2 0           bn4c_branch2b[0][0]              
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, None, None, 1 262144      res4c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, None, None, 1 4096        res4c_branch2c[0][0]             
__________________________________________________________________________________________________
res4c (Add)                     (None, None, None, 1 0           bn4c_branch2c[0][0]              
                                                                 res4b_relu[0][0]                 
__________________________________________________________________________________________________
res4c_relu (Activation)         (None, None, None, 1 0           res4c[0][0]                      
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, None, None, 2 262144      res4c_relu[0][0]                 
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, None, None, 2 1024        res4d_branch2a[0][0]             
__________________________________________________________________________________________________
res4d_branch2a_relu (Activation (None, None, None, 2 0           bn4d_branch2a[0][0]              
__________________________________________________________________________________________________
padding4d_branch2b (ZeroPadding (None, None, None, 2 0           res4d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, None, None, 2 589824      padding4d_branch2b[0][0]         
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, None, None, 2 1024        res4d_branch2b[0][0]             
__________________________________________________________________________________________________
res4d_branch2b_relu (Activation (None, None, None, 2 0           bn4d_branch2b[0][0]              
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, None, None, 1 262144      res4d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, None, None, 1 4096        res4d_branch2c[0][0]             
__________________________________________________________________________________________________
res4d (Add)                     (None, None, None, 1 0           bn4d_branch2c[0][0]              
                                                                 res4c_relu[0][0]                 
__________________________________________________________________________________________________
res4d_relu (Activation)         (None, None, None, 1 0           res4d[0][0]                      
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, None, None, 2 262144      res4d_relu[0][0]                 
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, None, None, 2 1024        res4e_branch2a[0][0]             
__________________________________________________________________________________________________
res4e_branch2a_relu (Activation (None, None, None, 2 0           bn4e_branch2a[0][0]              
__________________________________________________________________________________________________
padding4e_branch2b (ZeroPadding (None, None, None, 2 0           res4e_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, None, None, 2 589824      padding4e_branch2b[0][0]         
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, None, None, 2 1024        res4e_branch2b[0][0]             
__________________________________________________________________________________________________
res4e_branch2b_relu (Activation (None, None, None, 2 0           bn4e_branch2b[0][0]              
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, None, None, 1 262144      res4e_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, None, None, 1 4096        res4e_branch2c[0][0]             
__________________________________________________________________________________________________
res4e (Add)                     (None, None, None, 1 0           bn4e_branch2c[0][0]              
                                                                 res4d_relu[0][0]                 
__________________________________________________________________________________________________
res4e_relu (Activation)         (None, None, None, 1 0           res4e[0][0]                      
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, None, None, 2 262144      res4e_relu[0][0]                 
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, None, None, 2 1024        res4f_branch2a[0][0]             
__________________________________________________________________________________________________
res4f_branch2a_relu (Activation (None, None, None, 2 0           bn4f_branch2a[0][0]              
__________________________________________________________________________________________________
padding4f_branch2b (ZeroPadding (None, None, None, 2 0           res4f_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, None, None, 2 589824      padding4f_branch2b[0][0]         
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, None, None, 2 1024        res4f_branch2b[0][0]             
__________________________________________________________________________________________________
res4f_branch2b_relu (Activation (None, None, None, 2 0           bn4f_branch2b[0][0]              
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, None, None, 1 262144      res4f_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, None, None, 1 4096        res4f_branch2c[0][0]             
__________________________________________________________________________________________________
res4f (Add)                     (None, None, None, 1 0           bn4f_branch2c[0][0]              
                                                                 res4e_relu[0][0]                 
__________________________________________________________________________________________________
res4f_relu (Activation)         (None, None, None, 1 0           res4f[0][0]                      
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, None, None, 5 524288      res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, None, None, 5 2048        res5a_branch2a[0][0]             
__________________________________________________________________________________________________
res5a_branch2a_relu (Activation (None, None, None, 5 0           bn5a_branch2a[0][0]              
__________________________________________________________________________________________________
padding5a_branch2b (ZeroPadding (None, None, None, 5 0           res5a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5a_branch2b[0][0]         
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, None, None, 5 2048        res5a_branch2b[0][0]             
__________________________________________________________________________________________________
res5a_branch2b_relu (Activation (None, None, None, 5 0           bn5a_branch2b[0][0]              
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, None, None, 2 1048576     res5a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, None, None, 2 2097152     res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, None, None, 2 8192        res5a_branch2c[0][0]             
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, None, None, 2 8192        res5a_branch1[0][0]              
__________________________________________________________________________________________________
res5a (Add)                     (None, None, None, 2 0           bn5a_branch2c[0][0]              
                                                                 bn5a_branch1[0][0]               
__________________________________________________________________________________________________
res5a_relu (Activation)         (None, None, None, 2 0           res5a[0][0]                      
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, None, None, 5 1048576     res5a_relu[0][0]                 
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, None, None, 5 2048        res5b_branch2a[0][0]             
__________________________________________________________________________________________________
res5b_branch2a_relu (Activation (None, None, None, 5 0           bn5b_branch2a[0][0]              
__________________________________________________________________________________________________
padding5b_branch2b (ZeroPadding (None, None, None, 5 0           res5b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5b_branch2b[0][0]         
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, None, None, 5 2048        res5b_branch2b[0][0]             
__________________________________________________________________________________________________
res5b_branch2b_relu (Activation (None, None, None, 5 0           bn5b_branch2b[0][0]              
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, None, None, 2 1048576     res5b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, None, None, 2 8192        res5b_branch2c[0][0]             
__________________________________________________________________________________________________
res5b (Add)                     (None, None, None, 2 0           bn5b_branch2c[0][0]              
                                                                 res5a_relu[0][0]                 
__________________________________________________________________________________________________
res5b_relu (Activation)         (None, None, None, 2 0           res5b[0][0]                      
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, None, None, 5 1048576     res5b_relu[0][0]                 
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, None, None, 5 2048        res5c_branch2a[0][0]             
__________________________________________________________________________________________________
res5c_branch2a_relu (Activation (None, None, None, 5 0           bn5c_branch2a[0][0]              
__________________________________________________________________________________________________
padding5c_branch2b (ZeroPadding (None, None, None, 5 0           res5c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5c_branch2b[0][0]         
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, None, None, 5 2048        res5c_branch2b[0][0]             
__________________________________________________________________________________________________
res5c_branch2b_relu (Activation (None, None, None, 5 0           bn5c_branch2b[0][0]              
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, None, None, 2 1048576     res5c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, None, None, 2 8192        res5c_branch2c[0][0]             
__________________________________________________________________________________________________
res5c (Add)                     (None, None, None, 2 0           bn5c_branch2c[0][0]              
                                                                 res5b_relu[0][0]                 
__________________________________________________________________________________________________
res5c_relu (Activation)         (None, None, None, 2 0           res5c[0][0]                      
__________________________________________________________________________________________________
C5_reduced (Conv2D)             (None, None, None, 2 524544      res5c_relu[0][0]                 
__________________________________________________________________________________________________
P5_upsampled (UpsampleLike)     (None, None, None, 2 0           C5_reduced[0][0]                 
                                                                 res4f_relu[0][0]                 
__________________________________________________________________________________________________
C4_reduced (Conv2D)             (None, None, None, 2 262400      res4f_relu[0][0]                 
__________________________________________________________________________________________________
P4_merged (Add)                 (None, None, None, 2 0           P5_upsampled[0][0]               
                                                                 C4_reduced[0][0]                 
__________________________________________________________________________________________________
P4_upsampled (UpsampleLike)     (None, None, None, 2 0           P4_merged[0][0]                  
                                                                 res3d_relu[0][0]                 
__________________________________________________________________________________________________
C3_reduced (Conv2D)             (None, None, None, 2 131328      res3d_relu[0][0]                 
__________________________________________________________________________________________________
P6 (Conv2D)                     (None, None, None, 2 4718848     res5c_relu[0][0]                 
__________________________________________________________________________________________________
P3_merged (Add)                 (None, None, None, 2 0           P4_upsampled[0][0]               
                                                                 C3_reduced[0][0]                 
__________________________________________________________________________________________________
C6_relu (Activation)            (None, None, None, 2 0           P6[0][0]                         
__________________________________________________________________________________________________
P3 (Conv2D)                     (None, None, None, 2 590080      P3_merged[0][0]                  
__________________________________________________________________________________________________
P4 (Conv2D)                     (None, None, None, 2 590080      P4_merged[0][0]                  
__________________________________________________________________________________________________
P5 (Conv2D)                     (None, None, None, 2 590080      C5_reduced[0][0]                 
__________________________________________________________________________________________________
P7 (Conv2D)                     (None, None, None, 2 590080      C6_relu[0][0]                    
__________________________________________________________________________________________________
regression_submodel (Model)     (None, None, 4)      2443300     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
classification_submodel (Model) (None, None, 37)     3127885     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
regression (Concatenate)        (None, None, 4)      0           regression_submodel[1][0]        
                                                                 regression_submodel[2][0]        
                                                                 regression_submodel[3][0]        
                                                                 regression_submodel[4][0]        
                                                                 regression_submodel[5][0]        
__________________________________________________________________________________________________
classification (Concatenate)    (None, None, 37)     0           classification_submodel[1][0]    
                                                                 classification_submodel[2][0]    
                                                                 classification_submodel[3][0]    
                                                                 classification_submodel[4][0]    
                                                                 classification_submodel[5][0]    
==================================================================================================
Total params: 37,129,777
Trainable params: 37,023,537
Non-trainable params: 106,240
__________________________________________________________________________________________________
None
Epoch 1/50
keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
2019-06-03 15:26:41.671578: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:41.710294: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:42.718254: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:42.836807: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:43.115857: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:43.244178: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:43.256599: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:43.260195: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:43.343957: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.13GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:26:43.476934: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
138/800 [====>.........................] - ETA: 14:22 - loss: 1.6745 - regression_loss: 1.2170 - classification_loss: 0.4575^CProcess ForkPoolWorker-2:
Process ForkPoolWorker-1:
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
KeyboardInterrupt
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
^CProcess ForkPoolWorker-3:
Process ForkPoolWorker-4:
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
KeyboardInterrupt
^CProcess ForkPoolWorker-6:
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Process ForkPoolWorker-5:
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
^CProcess ForkPoolWorker-7:
Traceback (most recent call last):
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training_generator.py", line 217, in fit_generator
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
    class_weight=class_weight)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training.py", line 1217, in train_on_batch
    outputs = self.train_function(ins)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2715, in __call__
    return self._call(inputs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py", line 2675, in _call
    fetched = self._callable_fn(*array_vals)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1439, in __call__
    run_metadata_ptr)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "keras_retinanet/bin/train.py", line 514, in <module>
    main()
  File "keras_retinanet/bin/train.py", line 509, in main
    validation_data=validation_generator
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training.py", line 1418, in fit_generator
    initial_epoch=initial_epoch)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training_generator.py", line 262, in fit_generator
    val_enqueuer.stop()
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/data_utils.py", line 496, in stop
    self.run_thread.join(timeout)
  File "/usr/lib/python3.6/threading.py", line 1056, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.6/threading.py", line 1072, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
^C^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/train.py --batch-size=1 --lr=1e-5 --random-transform --compute-val-loss --steps=280 --weighted-average --snapshot ./snapshots/resnet50_csv_08.h5 --snapshot-path ./snapshots csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_train.csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/class_mapping.csv --val-annotations /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_val.csv
Using TensorFlow backend.
2019-06-03 15:31:05.092363: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 15:31:05.188569: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-06-03 15:31:05.189650: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2031380 executing computations on platform CUDA. Devices:
2019-06-03 15:31:05.189667: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce GTX 960M, Compute Capability 5.0
2019-06-03 15:31:05.220041: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 15:31:05.220788: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x26f56e0 executing computations on platform Host. Devices:
2019-06-03 15:31:05.220805: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-06-03 15:31:05.221020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176
pciBusID: 0000:02:00.0
totalMemory: 3.95GiB freeMemory: 3.22GiB
2019-06-03 15:31:05.221035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2019-06-03 15:31:05.222742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-06-03 15:31:05.222771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2019-06-03 15:31:05.222777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2019-06-03 15:31:05.222917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2994 MB memory) -> physical GPU (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0, compute capability: 5.0)
Loading model, this may take a second...
WARNING:tensorflow:From /home/abert/.virtualenvs/test/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, None, None, 3 0                                            
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, None, None, 6 9408        input_1[0][0]                    
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, None, None, 6 256         conv1[0][0]                      
__________________________________________________________________________________________________
conv1_relu (Activation)         (None, None, None, 6 0           bn_conv1[0][0]                   
__________________________________________________________________________________________________
pool1 (MaxPooling2D)            (None, None, None, 6 0           conv1_relu[0][0]                 
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, None, None, 6 4096        pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, None, None, 6 256         res2a_branch2a[0][0]             
__________________________________________________________________________________________________
res2a_branch2a_relu (Activation (None, None, None, 6 0           bn2a_branch2a[0][0]              
__________________________________________________________________________________________________
padding2a_branch2b (ZeroPadding (None, None, None, 6 0           res2a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, None, None, 6 36864       padding2a_branch2b[0][0]         
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, None, None, 6 256         res2a_branch2b[0][0]             
__________________________________________________________________________________________________
res2a_branch2b_relu (Activation (None, None, None, 6 0           bn2a_branch2b[0][0]              
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, None, None, 2 16384       res2a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, None, None, 2 16384       pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, None, None, 2 1024        res2a_branch2c[0][0]             
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, None, None, 2 1024        res2a_branch1[0][0]              
__________________________________________________________________________________________________
res2a (Add)                     (None, None, None, 2 0           bn2a_branch2c[0][0]              
                                                                 bn2a_branch1[0][0]               
__________________________________________________________________________________________________
res2a_relu (Activation)         (None, None, None, 2 0           res2a[0][0]                      
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, None, None, 6 16384       res2a_relu[0][0]                 
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, None, None, 6 256         res2b_branch2a[0][0]             
__________________________________________________________________________________________________
res2b_branch2a_relu (Activation (None, None, None, 6 0           bn2b_branch2a[0][0]              
__________________________________________________________________________________________________
padding2b_branch2b (ZeroPadding (None, None, None, 6 0           res2b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, None, None, 6 36864       padding2b_branch2b[0][0]         
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, None, None, 6 256         res2b_branch2b[0][0]             
__________________________________________________________________________________________________
res2b_branch2b_relu (Activation (None, None, None, 6 0           bn2b_branch2b[0][0]              
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, None, None, 2 16384       res2b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, None, None, 2 1024        res2b_branch2c[0][0]             
__________________________________________________________________________________________________
res2b (Add)                     (None, None, None, 2 0           bn2b_branch2c[0][0]              
                                                                 res2a_relu[0][0]                 
__________________________________________________________________________________________________
res2b_relu (Activation)         (None, None, None, 2 0           res2b[0][0]                      
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, None, None, 6 16384       res2b_relu[0][0]                 
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, None, None, 6 256         res2c_branch2a[0][0]             
__________________________________________________________________________________________________
res2c_branch2a_relu (Activation (None, None, None, 6 0           bn2c_branch2a[0][0]              
__________________________________________________________________________________________________
padding2c_branch2b (ZeroPadding (None, None, None, 6 0           res2c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, None, None, 6 36864       padding2c_branch2b[0][0]         
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, None, None, 6 256         res2c_branch2b[0][0]             
__________________________________________________________________________________________________
res2c_branch2b_relu (Activation (None, None, None, 6 0           bn2c_branch2b[0][0]              
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, None, None, 2 16384       res2c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, None, None, 2 1024        res2c_branch2c[0][0]             
__________________________________________________________________________________________________
res2c (Add)                     (None, None, None, 2 0           bn2c_branch2c[0][0]              
                                                                 res2b_relu[0][0]                 
__________________________________________________________________________________________________
res2c_relu (Activation)         (None, None, None, 2 0           res2c[0][0]                      
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, None, None, 1 32768       res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, None, None, 1 512         res3a_branch2a[0][0]             
__________________________________________________________________________________________________
res3a_branch2a_relu (Activation (None, None, None, 1 0           bn3a_branch2a[0][0]              
__________________________________________________________________________________________________
padding3a_branch2b (ZeroPadding (None, None, None, 1 0           res3a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, None, None, 1 147456      padding3a_branch2b[0][0]         
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, None, None, 1 512         res3a_branch2b[0][0]             
__________________________________________________________________________________________________
res3a_branch2b_relu (Activation (None, None, None, 1 0           bn3a_branch2b[0][0]              
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, None, None, 5 65536       res3a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, None, None, 5 131072      res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, None, None, 5 2048        res3a_branch2c[0][0]             
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, None, None, 5 2048        res3a_branch1[0][0]              
__________________________________________________________________________________________________
res3a (Add)                     (None, None, None, 5 0           bn3a_branch2c[0][0]              
                                                                 bn3a_branch1[0][0]               
__________________________________________________________________________________________________
res3a_relu (Activation)         (None, None, None, 5 0           res3a[0][0]                      
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, None, None, 1 65536       res3a_relu[0][0]                 
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, None, None, 1 512         res3b_branch2a[0][0]             
__________________________________________________________________________________________________
res3b_branch2a_relu (Activation (None, None, None, 1 0           bn3b_branch2a[0][0]              
__________________________________________________________________________________________________
padding3b_branch2b (ZeroPadding (None, None, None, 1 0           res3b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, None, None, 1 147456      padding3b_branch2b[0][0]         
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, None, None, 1 512         res3b_branch2b[0][0]             
__________________________________________________________________________________________________
res3b_branch2b_relu (Activation (None, None, None, 1 0           bn3b_branch2b[0][0]              
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, None, None, 5 65536       res3b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, None, None, 5 2048        res3b_branch2c[0][0]             
__________________________________________________________________________________________________
res3b (Add)                     (None, None, None, 5 0           bn3b_branch2c[0][0]              
                                                                 res3a_relu[0][0]                 
__________________________________________________________________________________________________
res3b_relu (Activation)         (None, None, None, 5 0           res3b[0][0]                      
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, None, None, 1 65536       res3b_relu[0][0]                 
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, None, None, 1 512         res3c_branch2a[0][0]             
__________________________________________________________________________________________________
res3c_branch2a_relu (Activation (None, None, None, 1 0           bn3c_branch2a[0][0]              
__________________________________________________________________________________________________
padding3c_branch2b (ZeroPadding (None, None, None, 1 0           res3c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, None, None, 1 147456      padding3c_branch2b[0][0]         
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, None, None, 1 512         res3c_branch2b[0][0]             
__________________________________________________________________________________________________
res3c_branch2b_relu (Activation (None, None, None, 1 0           bn3c_branch2b[0][0]              
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, None, None, 5 65536       res3c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, None, None, 5 2048        res3c_branch2c[0][0]             
__________________________________________________________________________________________________
res3c (Add)                     (None, None, None, 5 0           bn3c_branch2c[0][0]              
                                                                 res3b_relu[0][0]                 
__________________________________________________________________________________________________
res3c_relu (Activation)         (None, None, None, 5 0           res3c[0][0]                      
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, None, None, 1 65536       res3c_relu[0][0]                 
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, None, None, 1 512         res3d_branch2a[0][0]             
__________________________________________________________________________________________________
res3d_branch2a_relu (Activation (None, None, None, 1 0           bn3d_branch2a[0][0]              
__________________________________________________________________________________________________
padding3d_branch2b (ZeroPadding (None, None, None, 1 0           res3d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, None, None, 1 147456      padding3d_branch2b[0][0]         
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, None, None, 1 512         res3d_branch2b[0][0]             
__________________________________________________________________________________________________
res3d_branch2b_relu (Activation (None, None, None, 1 0           bn3d_branch2b[0][0]              
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, None, None, 5 65536       res3d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, None, None, 5 2048        res3d_branch2c[0][0]             
__________________________________________________________________________________________________
res3d (Add)                     (None, None, None, 5 0           bn3d_branch2c[0][0]              
                                                                 res3c_relu[0][0]                 
__________________________________________________________________________________________________
res3d_relu (Activation)         (None, None, None, 5 0           res3d[0][0]                      
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, None, None, 2 131072      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, None, None, 2 1024        res4a_branch2a[0][0]             
__________________________________________________________________________________________________
res4a_branch2a_relu (Activation (None, None, None, 2 0           bn4a_branch2a[0][0]              
__________________________________________________________________________________________________
padding4a_branch2b (ZeroPadding (None, None, None, 2 0           res4a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, None, None, 2 589824      padding4a_branch2b[0][0]         
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, None, None, 2 1024        res4a_branch2b[0][0]             
__________________________________________________________________________________________________
res4a_branch2b_relu (Activation (None, None, None, 2 0           bn4a_branch2b[0][0]              
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, None, None, 1 262144      res4a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, None, None, 1 524288      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, None, None, 1 4096        res4a_branch2c[0][0]             
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, None, None, 1 4096        res4a_branch1[0][0]              
__________________________________________________________________________________________________
res4a (Add)                     (None, None, None, 1 0           bn4a_branch2c[0][0]              
                                                                 bn4a_branch1[0][0]               
__________________________________________________________________________________________________
res4a_relu (Activation)         (None, None, None, 1 0           res4a[0][0]                      
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, None, None, 2 262144      res4a_relu[0][0]                 
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, None, None, 2 1024        res4b_branch2a[0][0]             
__________________________________________________________________________________________________
res4b_branch2a_relu (Activation (None, None, None, 2 0           bn4b_branch2a[0][0]              
__________________________________________________________________________________________________
padding4b_branch2b (ZeroPadding (None, None, None, 2 0           res4b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, None, None, 2 589824      padding4b_branch2b[0][0]         
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, None, None, 2 1024        res4b_branch2b[0][0]             
__________________________________________________________________________________________________
res4b_branch2b_relu (Activation (None, None, None, 2 0           bn4b_branch2b[0][0]              
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, None, None, 1 262144      res4b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, None, None, 1 4096        res4b_branch2c[0][0]             
__________________________________________________________________________________________________
res4b (Add)                     (None, None, None, 1 0           bn4b_branch2c[0][0]              
                                                                 res4a_relu[0][0]                 
__________________________________________________________________________________________________
res4b_relu (Activation)         (None, None, None, 1 0           res4b[0][0]                      
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, None, None, 2 262144      res4b_relu[0][0]                 
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, None, None, 2 1024        res4c_branch2a[0][0]             
__________________________________________________________________________________________________
res4c_branch2a_relu (Activation (None, None, None, 2 0           bn4c_branch2a[0][0]              
__________________________________________________________________________________________________
padding4c_branch2b (ZeroPadding (None, None, None, 2 0           res4c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, None, None, 2 589824      padding4c_branch2b[0][0]         
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, None, None, 2 1024        res4c_branch2b[0][0]             
__________________________________________________________________________________________________
res4c_branch2b_relu (Activation (None, None, None, 2 0           bn4c_branch2b[0][0]              
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, None, None, 1 262144      res4c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, None, None, 1 4096        res4c_branch2c[0][0]             
__________________________________________________________________________________________________
res4c (Add)                     (None, None, None, 1 0           bn4c_branch2c[0][0]              
                                                                 res4b_relu[0][0]                 
__________________________________________________________________________________________________
res4c_relu (Activation)         (None, None, None, 1 0           res4c[0][0]                      
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, None, None, 2 262144      res4c_relu[0][0]                 
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, None, None, 2 1024        res4d_branch2a[0][0]             
__________________________________________________________________________________________________
res4d_branch2a_relu (Activation (None, None, None, 2 0           bn4d_branch2a[0][0]              
__________________________________________________________________________________________________
padding4d_branch2b (ZeroPadding (None, None, None, 2 0           res4d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, None, None, 2 589824      padding4d_branch2b[0][0]         
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, None, None, 2 1024        res4d_branch2b[0][0]             
__________________________________________________________________________________________________
res4d_branch2b_relu (Activation (None, None, None, 2 0           bn4d_branch2b[0][0]              
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, None, None, 1 262144      res4d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, None, None, 1 4096        res4d_branch2c[0][0]             
__________________________________________________________________________________________________
res4d (Add)                     (None, None, None, 1 0           bn4d_branch2c[0][0]              
                                                                 res4c_relu[0][0]                 
__________________________________________________________________________________________________
res4d_relu (Activation)         (None, None, None, 1 0           res4d[0][0]                      
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, None, None, 2 262144      res4d_relu[0][0]                 
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, None, None, 2 1024        res4e_branch2a[0][0]             
__________________________________________________________________________________________________
res4e_branch2a_relu (Activation (None, None, None, 2 0           bn4e_branch2a[0][0]              
__________________________________________________________________________________________________
padding4e_branch2b (ZeroPadding (None, None, None, 2 0           res4e_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, None, None, 2 589824      padding4e_branch2b[0][0]         
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, None, None, 2 1024        res4e_branch2b[0][0]             
__________________________________________________________________________________________________
res4e_branch2b_relu (Activation (None, None, None, 2 0           bn4e_branch2b[0][0]              
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, None, None, 1 262144      res4e_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, None, None, 1 4096        res4e_branch2c[0][0]             
__________________________________________________________________________________________________
res4e (Add)                     (None, None, None, 1 0           bn4e_branch2c[0][0]              
                                                                 res4d_relu[0][0]                 
__________________________________________________________________________________________________
res4e_relu (Activation)         (None, None, None, 1 0           res4e[0][0]                      
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, None, None, 2 262144      res4e_relu[0][0]                 
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, None, None, 2 1024        res4f_branch2a[0][0]             
__________________________________________________________________________________________________
res4f_branch2a_relu (Activation (None, None, None, 2 0           bn4f_branch2a[0][0]              
__________________________________________________________________________________________________
padding4f_branch2b (ZeroPadding (None, None, None, 2 0           res4f_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, None, None, 2 589824      padding4f_branch2b[0][0]         
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, None, None, 2 1024        res4f_branch2b[0][0]             
__________________________________________________________________________________________________
res4f_branch2b_relu (Activation (None, None, None, 2 0           bn4f_branch2b[0][0]              
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, None, None, 1 262144      res4f_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, None, None, 1 4096        res4f_branch2c[0][0]             
__________________________________________________________________________________________________
res4f (Add)                     (None, None, None, 1 0           bn4f_branch2c[0][0]              
                                                                 res4e_relu[0][0]                 
__________________________________________________________________________________________________
res4f_relu (Activation)         (None, None, None, 1 0           res4f[0][0]                      
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, None, None, 5 524288      res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, None, None, 5 2048        res5a_branch2a[0][0]             
__________________________________________________________________________________________________
res5a_branch2a_relu (Activation (None, None, None, 5 0           bn5a_branch2a[0][0]              
__________________________________________________________________________________________________
padding5a_branch2b (ZeroPadding (None, None, None, 5 0           res5a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5a_branch2b[0][0]         
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, None, None, 5 2048        res5a_branch2b[0][0]             
__________________________________________________________________________________________________
res5a_branch2b_relu (Activation (None, None, None, 5 0           bn5a_branch2b[0][0]              
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, None, None, 2 1048576     res5a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, None, None, 2 2097152     res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, None, None, 2 8192        res5a_branch2c[0][0]             
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, None, None, 2 8192        res5a_branch1[0][0]              
__________________________________________________________________________________________________
res5a (Add)                     (None, None, None, 2 0           bn5a_branch2c[0][0]              
                                                                 bn5a_branch1[0][0]               
__________________________________________________________________________________________________
res5a_relu (Activation)         (None, None, None, 2 0           res5a[0][0]                      
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, None, None, 5 1048576     res5a_relu[0][0]                 
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, None, None, 5 2048        res5b_branch2a[0][0]             
__________________________________________________________________________________________________
res5b_branch2a_relu (Activation (None, None, None, 5 0           bn5b_branch2a[0][0]              
__________________________________________________________________________________________________
padding5b_branch2b (ZeroPadding (None, None, None, 5 0           res5b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5b_branch2b[0][0]         
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, None, None, 5 2048        res5b_branch2b[0][0]             
__________________________________________________________________________________________________
res5b_branch2b_relu (Activation (None, None, None, 5 0           bn5b_branch2b[0][0]              
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, None, None, 2 1048576     res5b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, None, None, 2 8192        res5b_branch2c[0][0]             
__________________________________________________________________________________________________
res5b (Add)                     (None, None, None, 2 0           bn5b_branch2c[0][0]              
                                                                 res5a_relu[0][0]                 
__________________________________________________________________________________________________
res5b_relu (Activation)         (None, None, None, 2 0           res5b[0][0]                      
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, None, None, 5 1048576     res5b_relu[0][0]                 
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, None, None, 5 2048        res5c_branch2a[0][0]             
__________________________________________________________________________________________________
res5c_branch2a_relu (Activation (None, None, None, 5 0           bn5c_branch2a[0][0]              
__________________________________________________________________________________________________
padding5c_branch2b (ZeroPadding (None, None, None, 5 0           res5c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5c_branch2b[0][0]         
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, None, None, 5 2048        res5c_branch2b[0][0]             
__________________________________________________________________________________________________
res5c_branch2b_relu (Activation (None, None, None, 5 0           bn5c_branch2b[0][0]              
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, None, None, 2 1048576     res5c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, None, None, 2 8192        res5c_branch2c[0][0]             
__________________________________________________________________________________________________
res5c (Add)                     (None, None, None, 2 0           bn5c_branch2c[0][0]              
                                                                 res5b_relu[0][0]                 
__________________________________________________________________________________________________
res5c_relu (Activation)         (None, None, None, 2 0           res5c[0][0]                      
__________________________________________________________________________________________________
C5_reduced (Conv2D)             (None, None, None, 2 524544      res5c_relu[0][0]                 
__________________________________________________________________________________________________
P5_upsampled (UpsampleLike)     (None, None, None, 2 0           C5_reduced[0][0]                 
                                                                 res4f_relu[0][0]                 
__________________________________________________________________________________________________
C4_reduced (Conv2D)             (None, None, None, 2 262400      res4f_relu[0][0]                 
__________________________________________________________________________________________________
P4_merged (Add)                 (None, None, None, 2 0           P5_upsampled[0][0]               
                                                                 C4_reduced[0][0]                 
__________________________________________________________________________________________________
P4_upsampled (UpsampleLike)     (None, None, None, 2 0           P4_merged[0][0]                  
                                                                 res3d_relu[0][0]                 
__________________________________________________________________________________________________
C3_reduced (Conv2D)             (None, None, None, 2 131328      res3d_relu[0][0]                 
__________________________________________________________________________________________________
P6 (Conv2D)                     (None, None, None, 2 4718848     res5c_relu[0][0]                 
__________________________________________________________________________________________________
P3_merged (Add)                 (None, None, None, 2 0           P4_upsampled[0][0]               
                                                                 C3_reduced[0][0]                 
__________________________________________________________________________________________________
C6_relu (Activation)            (None, None, None, 2 0           P6[0][0]                         
__________________________________________________________________________________________________
P3 (Conv2D)                     (None, None, None, 2 590080      P3_merged[0][0]                  
__________________________________________________________________________________________________
P4 (Conv2D)                     (None, None, None, 2 590080      P4_merged[0][0]                  
__________________________________________________________________________________________________
P5 (Conv2D)                     (None, None, None, 2 590080      C5_reduced[0][0]                 
__________________________________________________________________________________________________
P7 (Conv2D)                     (None, None, None, 2 590080      C6_relu[0][0]                    
__________________________________________________________________________________________________
regression_submodel (Model)     (None, None, 4)      2443300     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
classification_submodel (Model) (None, None, 37)     3127885     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
regression (Concatenate)        (None, None, 4)      0           regression_submodel[1][0]        
                                                                 regression_submodel[2][0]        
                                                                 regression_submodel[3][0]        
                                                                 regression_submodel[4][0]        
                                                                 regression_submodel[5][0]        
__________________________________________________________________________________________________
classification (Concatenate)    (None, None, 37)     0           classification_submodel[1][0]    
                                                                 classification_submodel[2][0]    
                                                                 classification_submodel[3][0]    
                                                                 classification_submodel[4][0]    
                                                                 classification_submodel[5][0]    
==================================================================================================
Total params: 37,129,777
Trainable params: 37,023,537
Non-trainable params: 106,240
__________________________________________________________________________________________________
None
Epoch 1/50
keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
2019-06-03 15:31:30.376183: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:30.415151: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:31.425398: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:31.546498: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:31.829880: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:31.978285: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:31.991718: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:31.995953: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:32.084122: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.13GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 15:31:32.216839: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
 68/280 [======>.......................] - ETA: 4:54 - loss: 2.0738 - regression_loss: 1.3933 - classification_loss: 0.6806keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 402s 1s/step - loss: 1.5947 - regression_loss: 1.1851 - classification_loss: 0.4096 - val_loss: 1.7668 - val_regression_loss: 1.3697 - val_classification_loss: 0.3971
Running network: N/A% (0 of 52) |                                                                                                                                      | Elapsed Time: 0:00:00 ETA:  --:--:--2019-06-03 15:38:06.855324: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_2. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 15:38:06.855374: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_3. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 15:38:06.855389: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_4. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 15:38:06.855412: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_5. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 15:38:07.343288: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_2. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 15:38:07.343339: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_3. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 15:38:07.343353: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_4. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 15:38:07.343366: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_5. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:21 Time:  0:00:21
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.6714
74 instances of class 1 with average precision: 0.4889
89 instances of class 2 with average precision: 0.5950
36 instances of class 3 with average precision: 0.5448
20 instances of class 4 with average precision: 0.4449
42 instances of class 5 with average precision: 0.5580
30 instances of class 6 with average precision: 0.2653
22 instances of class 7 with average precision: 0.4023
31 instances of class 8 with average precision: 0.7427
53 instances of class 9 with average precision: 0.5122
49 instances of class / with average precision: 0.5490
59 instances of class A with average precision: 0.6344
45 instances of class B with average precision: 0.5744
92 instances of class C with average precision: 0.6628
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.3200
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.5893
3 instances of class N with average precision: 0.3333
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.5000
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.4530
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.5712

Epoch 00001: saving model to ./snapshots/resnet50_csv_01.h5
Epoch 2/50
185/280 [==================>...........] - ETA: 1:52 - loss: 1.3003 - regression_loss: 1.0347 - classification_loss: 0.2655keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
279/280 [============================>.] - ETA: 1s - loss: 1.3070 - regression_loss: 1.0419 - classification_loss: 0.2651keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 349s 1s/step - loss: 1.3039 - regression_loss: 1.0395 - classification_loss: 0.2644 - val_loss: 1.6614 - val_regression_loss: 1.3102 - val_classification_loss: 0.3512
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7109
74 instances of class 1 with average precision: 0.6030
89 instances of class 2 with average precision: 0.6325
36 instances of class 3 with average precision: 0.6326
20 instances of class 4 with average precision: 0.5441
42 instances of class 5 with average precision: 0.5750
30 instances of class 6 with average precision: 0.2376
22 instances of class 7 with average precision: 0.3312
31 instances of class 8 with average precision: 0.8330
53 instances of class 9 with average precision: 0.5625
49 instances of class / with average precision: 0.6161
59 instances of class A with average precision: 0.6832
45 instances of class B with average precision: 0.6624
92 instances of class C with average precision: 0.7251
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.4333
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.6995
3 instances of class N with average precision: 0.3333
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.6667
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.7058
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6336

Epoch 00002: saving model to ./snapshots/resnet50_csv_02.h5
Epoch 3/50
 85/280 [========>.....................] - ETA: 3:52 - loss: 1.2914 - regression_loss: 1.0332 - classification_loss: 0.2582keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
279/280 [============================>.] - ETA: 1s - loss: 1.2751 - regression_loss: 1.0169 - classification_loss: 0.2582keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 350s 1s/step - loss: 1.2734 - regression_loss: 1.0154 - classification_loss: 0.2580 - val_loss: 1.7345 - val_regression_loss: 1.3403 - val_classification_loss: 0.3942
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7051
74 instances of class 1 with average precision: 0.6311
89 instances of class 2 with average precision: 0.6875
36 instances of class 3 with average precision: 0.6633
20 instances of class 4 with average precision: 0.5918
42 instances of class 5 with average precision: 0.6006
30 instances of class 6 with average precision: 0.2832
22 instances of class 7 with average precision: 0.3996
31 instances of class 8 with average precision: 0.7622
53 instances of class 9 with average precision: 0.5164
49 instances of class / with average precision: 0.6210
59 instances of class A with average precision: 0.7856
45 instances of class B with average precision: 0.6795
92 instances of class C with average precision: 0.7019
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.6084
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.7089
3 instances of class N with average precision: 0.6667
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.7188
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.7417
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6517

Epoch 00003: saving model to ./snapshots/resnet50_csv_03.h5
Epoch 4/50
 96/280 [=========>....................] - ETA: 3:38 - loss: 1.2776 - regression_loss: 1.0386 - classification_loss: 0.2390keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
168/280 [=================>............] - ETA: 2:13 - loss: 1.3080 - regression_loss: 1.0495 - classification_loss: 0.2585keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
279/280 [============================>.] - ETA: 1s - loss: 1.2844 - regression_loss: 1.0296 - classification_loss: 0.2548keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 349s 1s/step - loss: 1.2812 - regression_loss: 1.0271 - classification_loss: 0.2541 - val_loss: 1.5092 - val_regression_loss: 1.1991 - val_classification_loss: 0.3101
Running network:   1% (1 of 52) |##                                                                                                                                    | Elapsed Time: 0:00:00 ETA:   0:00:19keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7027
74 instances of class 1 with average precision: 0.6457
89 instances of class 2 with average precision: 0.6794
36 instances of class 3 with average precision: 0.6192
20 instances of class 4 with average precision: 0.5758
42 instances of class 5 with average precision: 0.5740
30 instances of class 6 with average precision: 0.2908
22 instances of class 7 with average precision: 0.4671
31 instances of class 8 with average precision: 0.8384
53 instances of class 9 with average precision: 0.5013
49 instances of class / with average precision: 0.6477
59 instances of class A with average precision: 0.7427
45 instances of class B with average precision: 0.6380
92 instances of class C with average precision: 0.7168
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.7369
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.7140
3 instances of class N with average precision: 1.0000
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.6667
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.8066
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6538

Epoch 00004: saving model to ./snapshots/resnet50_csv_04.h5
Epoch 5/50
145/280 [==============>...............] - ETA: 2:39 - loss: 1.2195 - regression_loss: 0.9966 - classification_loss: 0.2229keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 348s 1s/step - loss: 1.2944 - regression_loss: 1.0524 - classification_loss: 0.2420 - val_loss: 1.5346 - val_regression_loss: 1.2197 - val_classification_loss: 0.3148
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7234
74 instances of class 1 with average precision: 0.6434
89 instances of class 2 with average precision: 0.7051
36 instances of class 3 with average precision: 0.6813
20 instances of class 4 with average precision: 0.6475
42 instances of class 5 with average precision: 0.6135
30 instances of class 6 with average precision: 0.3929
22 instances of class 7 with average precision: 0.5380
31 instances of class 8 with average precision: 0.8324
53 instances of class 9 with average precision: 0.6238
49 instances of class / with average precision: 0.6451
59 instances of class A with average precision: 0.7663
45 instances of class B with average precision: 0.7023
92 instances of class C with average precision: 0.7171
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.8267
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.7187
3 instances of class N with average precision: 1.0000
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.7857
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.8072
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6840

Epoch 00005: saving model to ./snapshots/resnet50_csv_05.h5

Epoch 00005: ReduceLROnPlateau reducing learning rate to 9.999999747378752e-06.
Epoch 6/50
105/280 [==========>...................] - ETA: 3:25 - loss: 0.9710 - regression_loss: 0.8025 - classification_loss: 0.1685Exception in thread Thread-3:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/data_utils.py", line 565, in _run
    with closing(self.executor_fn(_SHARED_SEQUENCES)) as executor:
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/data_utils.py", line 548, in <lambda>
    initargs=(seqs,))
  File "/usr/lib/python3.6/multiprocessing/context.py", line 119, in Pool
    context=self.get_context())
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 175, in __init__
    self._repopulate_pool()
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 236, in _repopulate_pool
    self._wrap_exception)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 255, in _repopulate_pool_static
    w.start()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/usr/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/usr/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/usr/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory

106/280 [==========>...................] - ETA: 3:24 - loss: 0.9943 - regression_loss: 0.8184 - classification_loss: 0.1759^CProcess ForkPoolWorker-12:
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/usr/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/usr/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Traceback (most recent call last):
  File "keras_retinanet/bin/train.py", line 514, in <module>
    main()
  File "keras_retinanet/bin/train.py", line 509, in main
    validation_data=validation_generator
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training.py", line 1418, in fit_generator
    initial_epoch=initial_epoch)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training_generator.py", line 181, in fit_generator
    generator_output = next(output_generator)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/data_utils.py", line 595, in get
    inputs = self.queue.get(block=True).get()
  File "/usr/lib/python3.6/queue.py", line 164, in get
    self.not_empty.wait()
  File "/usr/lib/python3.6/threading.py", line 295, in wait
    waiter.acquire()
KeyboardInterrupt
^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ ^C
(test) abert@rusty:~/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/step4_letter_detection/retinanet$ keras_retinanet/bin/train.py --batch-size=1 --lr=1e-6 --random-transform --compute-val-loss --steps=280 --weighted-average --snapshot ./snapshots/real_epoch5.h5 --snapshot-path ./snapshots csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_train.csv /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/class_mapping.csv --val-annotations /home/abert/Documents/NumeriCube/eurosilicone/gcaesthetics-implantbox/dataset/step4_ocr/ann_val.csv
Using TensorFlow backend.
2019-06-03 16:11:41.362625: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-06-03 16:11:41.442746: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-06-03 16:11:41.443476: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x1fcb370 executing computations on platform CUDA. Devices:
2019-06-03 16:11:41.443490: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce GTX 960M, Compute Capability 5.0
2019-06-03 16:11:41.476210: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2592000000 Hz
2019-06-03 16:11:41.477312: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x268f6d0 executing computations on platform Host. Devices:
2019-06-03 16:11:41.477364: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-06-03 16:11:41.477805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.176
pciBusID: 0000:02:00.0
totalMemory: 3.95GiB freeMemory: 3.26GiB
2019-06-03 16:11:41.477847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2019-06-03 16:11:41.480332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-06-03 16:11:41.480380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2019-06-03 16:11:41.480401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2019-06-03 16:11:41.480703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3042 MB memory) -> physical GPU (device: 0, name: GeForce GTX 960M, pci bus id: 0000:02:00.0, compute capability: 5.0)
Loading model, this may take a second...
WARNING:tensorflow:From /home/abert/.virtualenvs/test/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, None, None, 3 0                                            
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, None, None, 6 9408        input_1[0][0]                    
__________________________________________________________________________________________________
bn_conv1 (BatchNormalization)   (None, None, None, 6 256         conv1[0][0]                      
__________________________________________________________________________________________________
conv1_relu (Activation)         (None, None, None, 6 0           bn_conv1[0][0]                   
__________________________________________________________________________________________________
pool1 (MaxPooling2D)            (None, None, None, 6 0           conv1_relu[0][0]                 
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, None, None, 6 4096        pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, None, None, 6 256         res2a_branch2a[0][0]             
__________________________________________________________________________________________________
res2a_branch2a_relu (Activation (None, None, None, 6 0           bn2a_branch2a[0][0]              
__________________________________________________________________________________________________
padding2a_branch2b (ZeroPadding (None, None, None, 6 0           res2a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, None, None, 6 36864       padding2a_branch2b[0][0]         
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, None, None, 6 256         res2a_branch2b[0][0]             
__________________________________________________________________________________________________
res2a_branch2b_relu (Activation (None, None, None, 6 0           bn2a_branch2b[0][0]              
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, None, None, 2 16384       res2a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, None, None, 2 16384       pool1[0][0]                      
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, None, None, 2 1024        res2a_branch2c[0][0]             
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, None, None, 2 1024        res2a_branch1[0][0]              
__________________________________________________________________________________________________
res2a (Add)                     (None, None, None, 2 0           bn2a_branch2c[0][0]              
                                                                 bn2a_branch1[0][0]               
__________________________________________________________________________________________________
res2a_relu (Activation)         (None, None, None, 2 0           res2a[0][0]                      
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, None, None, 6 16384       res2a_relu[0][0]                 
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, None, None, 6 256         res2b_branch2a[0][0]             
__________________________________________________________________________________________________
res2b_branch2a_relu (Activation (None, None, None, 6 0           bn2b_branch2a[0][0]              
__________________________________________________________________________________________________
padding2b_branch2b (ZeroPadding (None, None, None, 6 0           res2b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, None, None, 6 36864       padding2b_branch2b[0][0]         
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, None, None, 6 256         res2b_branch2b[0][0]             
__________________________________________________________________________________________________
res2b_branch2b_relu (Activation (None, None, None, 6 0           bn2b_branch2b[0][0]              
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, None, None, 2 16384       res2b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, None, None, 2 1024        res2b_branch2c[0][0]             
__________________________________________________________________________________________________
res2b (Add)                     (None, None, None, 2 0           bn2b_branch2c[0][0]              
                                                                 res2a_relu[0][0]                 
__________________________________________________________________________________________________
res2b_relu (Activation)         (None, None, None, 2 0           res2b[0][0]                      
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, None, None, 6 16384       res2b_relu[0][0]                 
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, None, None, 6 256         res2c_branch2a[0][0]             
__________________________________________________________________________________________________
res2c_branch2a_relu (Activation (None, None, None, 6 0           bn2c_branch2a[0][0]              
__________________________________________________________________________________________________
padding2c_branch2b (ZeroPadding (None, None, None, 6 0           res2c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, None, None, 6 36864       padding2c_branch2b[0][0]         
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, None, None, 6 256         res2c_branch2b[0][0]             
__________________________________________________________________________________________________
res2c_branch2b_relu (Activation (None, None, None, 6 0           bn2c_branch2b[0][0]              
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, None, None, 2 16384       res2c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, None, None, 2 1024        res2c_branch2c[0][0]             
__________________________________________________________________________________________________
res2c (Add)                     (None, None, None, 2 0           bn2c_branch2c[0][0]              
                                                                 res2b_relu[0][0]                 
__________________________________________________________________________________________________
res2c_relu (Activation)         (None, None, None, 2 0           res2c[0][0]                      
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, None, None, 1 32768       res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, None, None, 1 512         res3a_branch2a[0][0]             
__________________________________________________________________________________________________
res3a_branch2a_relu (Activation (None, None, None, 1 0           bn3a_branch2a[0][0]              
__________________________________________________________________________________________________
padding3a_branch2b (ZeroPadding (None, None, None, 1 0           res3a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, None, None, 1 147456      padding3a_branch2b[0][0]         
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, None, None, 1 512         res3a_branch2b[0][0]             
__________________________________________________________________________________________________
res3a_branch2b_relu (Activation (None, None, None, 1 0           bn3a_branch2b[0][0]              
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, None, None, 5 65536       res3a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, None, None, 5 131072      res2c_relu[0][0]                 
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, None, None, 5 2048        res3a_branch2c[0][0]             
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, None, None, 5 2048        res3a_branch1[0][0]              
__________________________________________________________________________________________________
res3a (Add)                     (None, None, None, 5 0           bn3a_branch2c[0][0]              
                                                                 bn3a_branch1[0][0]               
__________________________________________________________________________________________________
res3a_relu (Activation)         (None, None, None, 5 0           res3a[0][0]                      
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, None, None, 1 65536       res3a_relu[0][0]                 
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, None, None, 1 512         res3b_branch2a[0][0]             
__________________________________________________________________________________________________
res3b_branch2a_relu (Activation (None, None, None, 1 0           bn3b_branch2a[0][0]              
__________________________________________________________________________________________________
padding3b_branch2b (ZeroPadding (None, None, None, 1 0           res3b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, None, None, 1 147456      padding3b_branch2b[0][0]         
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, None, None, 1 512         res3b_branch2b[0][0]             
__________________________________________________________________________________________________
res3b_branch2b_relu (Activation (None, None, None, 1 0           bn3b_branch2b[0][0]              
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, None, None, 5 65536       res3b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, None, None, 5 2048        res3b_branch2c[0][0]             
__________________________________________________________________________________________________
res3b (Add)                     (None, None, None, 5 0           bn3b_branch2c[0][0]              
                                                                 res3a_relu[0][0]                 
__________________________________________________________________________________________________
res3b_relu (Activation)         (None, None, None, 5 0           res3b[0][0]                      
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, None, None, 1 65536       res3b_relu[0][0]                 
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, None, None, 1 512         res3c_branch2a[0][0]             
__________________________________________________________________________________________________
res3c_branch2a_relu (Activation (None, None, None, 1 0           bn3c_branch2a[0][0]              
__________________________________________________________________________________________________
padding3c_branch2b (ZeroPadding (None, None, None, 1 0           res3c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, None, None, 1 147456      padding3c_branch2b[0][0]         
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, None, None, 1 512         res3c_branch2b[0][0]             
__________________________________________________________________________________________________
res3c_branch2b_relu (Activation (None, None, None, 1 0           bn3c_branch2b[0][0]              
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, None, None, 5 65536       res3c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, None, None, 5 2048        res3c_branch2c[0][0]             
__________________________________________________________________________________________________
res3c (Add)                     (None, None, None, 5 0           bn3c_branch2c[0][0]              
                                                                 res3b_relu[0][0]                 
__________________________________________________________________________________________________
res3c_relu (Activation)         (None, None, None, 5 0           res3c[0][0]                      
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, None, None, 1 65536       res3c_relu[0][0]                 
__________________________________________________________________________________________________
bn3d_branch2a (BatchNormalizati (None, None, None, 1 512         res3d_branch2a[0][0]             
__________________________________________________________________________________________________
res3d_branch2a_relu (Activation (None, None, None, 1 0           bn3d_branch2a[0][0]              
__________________________________________________________________________________________________
padding3d_branch2b (ZeroPadding (None, None, None, 1 0           res3d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, None, None, 1 147456      padding3d_branch2b[0][0]         
__________________________________________________________________________________________________
bn3d_branch2b (BatchNormalizati (None, None, None, 1 512         res3d_branch2b[0][0]             
__________________________________________________________________________________________________
res3d_branch2b_relu (Activation (None, None, None, 1 0           bn3d_branch2b[0][0]              
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, None, None, 5 65536       res3d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn3d_branch2c (BatchNormalizati (None, None, None, 5 2048        res3d_branch2c[0][0]             
__________________________________________________________________________________________________
res3d (Add)                     (None, None, None, 5 0           bn3d_branch2c[0][0]              
                                                                 res3c_relu[0][0]                 
__________________________________________________________________________________________________
res3d_relu (Activation)         (None, None, None, 5 0           res3d[0][0]                      
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, None, None, 2 131072      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, None, None, 2 1024        res4a_branch2a[0][0]             
__________________________________________________________________________________________________
res4a_branch2a_relu (Activation (None, None, None, 2 0           bn4a_branch2a[0][0]              
__________________________________________________________________________________________________
padding4a_branch2b (ZeroPadding (None, None, None, 2 0           res4a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, None, None, 2 589824      padding4a_branch2b[0][0]         
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, None, None, 2 1024        res4a_branch2b[0][0]             
__________________________________________________________________________________________________
res4a_branch2b_relu (Activation (None, None, None, 2 0           bn4a_branch2b[0][0]              
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, None, None, 1 262144      res4a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, None, None, 1 524288      res3d_relu[0][0]                 
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, None, None, 1 4096        res4a_branch2c[0][0]             
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, None, None, 1 4096        res4a_branch1[0][0]              
__________________________________________________________________________________________________
res4a (Add)                     (None, None, None, 1 0           bn4a_branch2c[0][0]              
                                                                 bn4a_branch1[0][0]               
__________________________________________________________________________________________________
res4a_relu (Activation)         (None, None, None, 1 0           res4a[0][0]                      
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, None, None, 2 262144      res4a_relu[0][0]                 
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, None, None, 2 1024        res4b_branch2a[0][0]             
__________________________________________________________________________________________________
res4b_branch2a_relu (Activation (None, None, None, 2 0           bn4b_branch2a[0][0]              
__________________________________________________________________________________________________
padding4b_branch2b (ZeroPadding (None, None, None, 2 0           res4b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, None, None, 2 589824      padding4b_branch2b[0][0]         
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, None, None, 2 1024        res4b_branch2b[0][0]             
__________________________________________________________________________________________________
res4b_branch2b_relu (Activation (None, None, None, 2 0           bn4b_branch2b[0][0]              
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, None, None, 1 262144      res4b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, None, None, 1 4096        res4b_branch2c[0][0]             
__________________________________________________________________________________________________
res4b (Add)                     (None, None, None, 1 0           bn4b_branch2c[0][0]              
                                                                 res4a_relu[0][0]                 
__________________________________________________________________________________________________
res4b_relu (Activation)         (None, None, None, 1 0           res4b[0][0]                      
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, None, None, 2 262144      res4b_relu[0][0]                 
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, None, None, 2 1024        res4c_branch2a[0][0]             
__________________________________________________________________________________________________
res4c_branch2a_relu (Activation (None, None, None, 2 0           bn4c_branch2a[0][0]              
__________________________________________________________________________________________________
padding4c_branch2b (ZeroPadding (None, None, None, 2 0           res4c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, None, None, 2 589824      padding4c_branch2b[0][0]         
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, None, None, 2 1024        res4c_branch2b[0][0]             
__________________________________________________________________________________________________
res4c_branch2b_relu (Activation (None, None, None, 2 0           bn4c_branch2b[0][0]              
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, None, None, 1 262144      res4c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, None, None, 1 4096        res4c_branch2c[0][0]             
__________________________________________________________________________________________________
res4c (Add)                     (None, None, None, 1 0           bn4c_branch2c[0][0]              
                                                                 res4b_relu[0][0]                 
__________________________________________________________________________________________________
res4c_relu (Activation)         (None, None, None, 1 0           res4c[0][0]                      
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, None, None, 2 262144      res4c_relu[0][0]                 
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, None, None, 2 1024        res4d_branch2a[0][0]             
__________________________________________________________________________________________________
res4d_branch2a_relu (Activation (None, None, None, 2 0           bn4d_branch2a[0][0]              
__________________________________________________________________________________________________
padding4d_branch2b (ZeroPadding (None, None, None, 2 0           res4d_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, None, None, 2 589824      padding4d_branch2b[0][0]         
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, None, None, 2 1024        res4d_branch2b[0][0]             
__________________________________________________________________________________________________
res4d_branch2b_relu (Activation (None, None, None, 2 0           bn4d_branch2b[0][0]              
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, None, None, 1 262144      res4d_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, None, None, 1 4096        res4d_branch2c[0][0]             
__________________________________________________________________________________________________
res4d (Add)                     (None, None, None, 1 0           bn4d_branch2c[0][0]              
                                                                 res4c_relu[0][0]                 
__________________________________________________________________________________________________
res4d_relu (Activation)         (None, None, None, 1 0           res4d[0][0]                      
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, None, None, 2 262144      res4d_relu[0][0]                 
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, None, None, 2 1024        res4e_branch2a[0][0]             
__________________________________________________________________________________________________
res4e_branch2a_relu (Activation (None, None, None, 2 0           bn4e_branch2a[0][0]              
__________________________________________________________________________________________________
padding4e_branch2b (ZeroPadding (None, None, None, 2 0           res4e_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, None, None, 2 589824      padding4e_branch2b[0][0]         
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, None, None, 2 1024        res4e_branch2b[0][0]             
__________________________________________________________________________________________________
res4e_branch2b_relu (Activation (None, None, None, 2 0           bn4e_branch2b[0][0]              
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, None, None, 1 262144      res4e_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, None, None, 1 4096        res4e_branch2c[0][0]             
__________________________________________________________________________________________________
res4e (Add)                     (None, None, None, 1 0           bn4e_branch2c[0][0]              
                                                                 res4d_relu[0][0]                 
__________________________________________________________________________________________________
res4e_relu (Activation)         (None, None, None, 1 0           res4e[0][0]                      
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, None, None, 2 262144      res4e_relu[0][0]                 
__________________________________________________________________________________________________
bn4f_branch2a (BatchNormalizati (None, None, None, 2 1024        res4f_branch2a[0][0]             
__________________________________________________________________________________________________
res4f_branch2a_relu (Activation (None, None, None, 2 0           bn4f_branch2a[0][0]              
__________________________________________________________________________________________________
padding4f_branch2b (ZeroPadding (None, None, None, 2 0           res4f_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, None, None, 2 589824      padding4f_branch2b[0][0]         
__________________________________________________________________________________________________
bn4f_branch2b (BatchNormalizati (None, None, None, 2 1024        res4f_branch2b[0][0]             
__________________________________________________________________________________________________
res4f_branch2b_relu (Activation (None, None, None, 2 0           bn4f_branch2b[0][0]              
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, None, None, 1 262144      res4f_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn4f_branch2c (BatchNormalizati (None, None, None, 1 4096        res4f_branch2c[0][0]             
__________________________________________________________________________________________________
res4f (Add)                     (None, None, None, 1 0           bn4f_branch2c[0][0]              
                                                                 res4e_relu[0][0]                 
__________________________________________________________________________________________________
res4f_relu (Activation)         (None, None, None, 1 0           res4f[0][0]                      
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, None, None, 5 524288      res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, None, None, 5 2048        res5a_branch2a[0][0]             
__________________________________________________________________________________________________
res5a_branch2a_relu (Activation (None, None, None, 5 0           bn5a_branch2a[0][0]              
__________________________________________________________________________________________________
padding5a_branch2b (ZeroPadding (None, None, None, 5 0           res5a_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5a_branch2b[0][0]         
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, None, None, 5 2048        res5a_branch2b[0][0]             
__________________________________________________________________________________________________
res5a_branch2b_relu (Activation (None, None, None, 5 0           bn5a_branch2b[0][0]              
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, None, None, 2 1048576     res5a_branch2b_relu[0][0]        
__________________________________________________________________________________________________
res5a_branch1 (Conv2D)          (None, None, None, 2 2097152     res4f_relu[0][0]                 
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, None, None, 2 8192        res5a_branch2c[0][0]             
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, None, None, 2 8192        res5a_branch1[0][0]              
__________________________________________________________________________________________________
res5a (Add)                     (None, None, None, 2 0           bn5a_branch2c[0][0]              
                                                                 bn5a_branch1[0][0]               
__________________________________________________________________________________________________
res5a_relu (Activation)         (None, None, None, 2 0           res5a[0][0]                      
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, None, None, 5 1048576     res5a_relu[0][0]                 
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, None, None, 5 2048        res5b_branch2a[0][0]             
__________________________________________________________________________________________________
res5b_branch2a_relu (Activation (None, None, None, 5 0           bn5b_branch2a[0][0]              
__________________________________________________________________________________________________
padding5b_branch2b (ZeroPadding (None, None, None, 5 0           res5b_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5b_branch2b[0][0]         
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, None, None, 5 2048        res5b_branch2b[0][0]             
__________________________________________________________________________________________________
res5b_branch2b_relu (Activation (None, None, None, 5 0           bn5b_branch2b[0][0]              
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, None, None, 2 1048576     res5b_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, None, None, 2 8192        res5b_branch2c[0][0]             
__________________________________________________________________________________________________
res5b (Add)                     (None, None, None, 2 0           bn5b_branch2c[0][0]              
                                                                 res5a_relu[0][0]                 
__________________________________________________________________________________________________
res5b_relu (Activation)         (None, None, None, 2 0           res5b[0][0]                      
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, None, None, 5 1048576     res5b_relu[0][0]                 
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, None, None, 5 2048        res5c_branch2a[0][0]             
__________________________________________________________________________________________________
res5c_branch2a_relu (Activation (None, None, None, 5 0           bn5c_branch2a[0][0]              
__________________________________________________________________________________________________
padding5c_branch2b (ZeroPadding (None, None, None, 5 0           res5c_branch2a_relu[0][0]        
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, None, None, 5 2359296     padding5c_branch2b[0][0]         
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, None, None, 5 2048        res5c_branch2b[0][0]             
__________________________________________________________________________________________________
res5c_branch2b_relu (Activation (None, None, None, 5 0           bn5c_branch2b[0][0]              
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, None, None, 2 1048576     res5c_branch2b_relu[0][0]        
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, None, None, 2 8192        res5c_branch2c[0][0]             
__________________________________________________________________________________________________
res5c (Add)                     (None, None, None, 2 0           bn5c_branch2c[0][0]              
                                                                 res5b_relu[0][0]                 
__________________________________________________________________________________________________
res5c_relu (Activation)         (None, None, None, 2 0           res5c[0][0]                      
__________________________________________________________________________________________________
C5_reduced (Conv2D)             (None, None, None, 2 524544      res5c_relu[0][0]                 
__________________________________________________________________________________________________
P5_upsampled (UpsampleLike)     (None, None, None, 2 0           C5_reduced[0][0]                 
                                                                 res4f_relu[0][0]                 
__________________________________________________________________________________________________
C4_reduced (Conv2D)             (None, None, None, 2 262400      res4f_relu[0][0]                 
__________________________________________________________________________________________________
P4_merged (Add)                 (None, None, None, 2 0           P5_upsampled[0][0]               
                                                                 C4_reduced[0][0]                 
__________________________________________________________________________________________________
P4_upsampled (UpsampleLike)     (None, None, None, 2 0           P4_merged[0][0]                  
                                                                 res3d_relu[0][0]                 
__________________________________________________________________________________________________
C3_reduced (Conv2D)             (None, None, None, 2 131328      res3d_relu[0][0]                 
__________________________________________________________________________________________________
P6 (Conv2D)                     (None, None, None, 2 4718848     res5c_relu[0][0]                 
__________________________________________________________________________________________________
P3_merged (Add)                 (None, None, None, 2 0           P4_upsampled[0][0]               
                                                                 C3_reduced[0][0]                 
__________________________________________________________________________________________________
C6_relu (Activation)            (None, None, None, 2 0           P6[0][0]                         
__________________________________________________________________________________________________
P3 (Conv2D)                     (None, None, None, 2 590080      P3_merged[0][0]                  
__________________________________________________________________________________________________
P4 (Conv2D)                     (None, None, None, 2 590080      P4_merged[0][0]                  
__________________________________________________________________________________________________
P5 (Conv2D)                     (None, None, None, 2 590080      C5_reduced[0][0]                 
__________________________________________________________________________________________________
P7 (Conv2D)                     (None, None, None, 2 590080      C6_relu[0][0]                    
__________________________________________________________________________________________________
regression_submodel (Model)     (None, None, 4)      2443300     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
classification_submodel (Model) (None, None, 37)     3127885     P3[0][0]                         
                                                                 P4[0][0]                         
                                                                 P5[0][0]                         
                                                                 P6[0][0]                         
                                                                 P7[0][0]                         
__________________________________________________________________________________________________
regression (Concatenate)        (None, None, 4)      0           regression_submodel[1][0]        
                                                                 regression_submodel[2][0]        
                                                                 regression_submodel[3][0]        
                                                                 regression_submodel[4][0]        
                                                                 regression_submodel[5][0]        
__________________________________________________________________________________________________
classification (Concatenate)    (None, None, 37)     0           classification_submodel[1][0]    
                                                                 classification_submodel[2][0]    
                                                                 classification_submodel[3][0]    
                                                                 classification_submodel[4][0]    
                                                                 classification_submodel[5][0]    
==================================================================================================
Total params: 37,129,777
Trainable params: 37,023,537
Non-trainable params: 106,240
__________________________________________________________________________________________________
None
Epoch 1/50
2019-06-03 16:12:05.474249: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:05.509801: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:06.519609: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:06.638244: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:06.922480: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:07.050980: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:07.063791: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:07.067555: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:07.152079: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.13GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2019-06-03 16:12:07.284996: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.07GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
120/280 [===========>..................] - ETA: 3:23 - loss: 1.2591 - regression_loss: 1.0117 - classification_loss: 0.2474keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
279/280 [============================>.] - ETA: 1s - loss: 1.1988 - regression_loss: 0.9738 - classification_loss: 0.2250keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 358s 1s/step - loss: 1.1973 - regression_loss: 0.9727 - classification_loss: 0.2246 - val_loss: 1.6178 - val_regression_loss: 1.2981 - val_classification_loss: 0.3196
Running network: N/A% (0 of 52) |                                                                                                                                      | Elapsed Time: 0:00:00 ETA:  --:--:--2019-06-03 16:17:58.645117: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_2. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 16:17:58.645167: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_3. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 16:17:58.645202: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_4. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 16:17:58.645223: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_5. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 16:17:59.111048: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_2. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 16:17:59.111093: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_3. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 16:17:59.111107: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_4. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
2019-06-03 16:17:59.111127: W ./tensorflow/core/grappler/optimizers/graph_optimizer_stage.h:241] Failed to run optimizer ArithmeticOptimizer, stage RemoveStackStridedSliceSameAxis node clipped_boxes/strided_slice_5. Error: Pack node (boxes/stack) axis attribute is out of bounds: 2
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:20 Time:  0:00:20
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7251
74 instances of class 1 with average precision: 0.6844
89 instances of class 2 with average precision: 0.6963
36 instances of class 3 with average precision: 0.5943
20 instances of class 4 with average precision: 0.6827
42 instances of class 5 with average precision: 0.6434
30 instances of class 6 with average precision: 0.3371
22 instances of class 7 with average precision: 0.4889
31 instances of class 8 with average precision: 0.8495
53 instances of class 9 with average precision: 0.6519
49 instances of class / with average precision: 0.5887
59 instances of class A with average precision: 0.7636
45 instances of class B with average precision: 0.6924
92 instances of class C with average precision: 0.7187
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.6917
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.6961
3 instances of class N with average precision: 1.0000
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.8056
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.8062
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6780

Epoch 00001: saving model to ./snapshots/resnet50_csv_01.h5
Epoch 2/50
210/280 [=====================>........] - ETA: 1:22 - loss: 1.2132 - regression_loss: 0.9887 - classification_loss: 0.2245keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
279/280 [============================>.] - ETA: 1s - loss: 1.1588 - regression_loss: 0.9426 - classification_loss: 0.2162keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 347s 1s/step - loss: 1.1650 - regression_loss: 0.9482 - classification_loss: 0.2168 - val_loss: 1.5943 - val_regression_loss: 1.2446 - val_classification_loss: 0.3496
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7292
74 instances of class 1 with average precision: 0.6933
89 instances of class 2 with average precision: 0.6882
36 instances of class 3 with average precision: 0.5911
20 instances of class 4 with average precision: 0.6700
42 instances of class 5 with average precision: 0.5412
30 instances of class 6 with average precision: 0.2639
22 instances of class 7 with average precision: 0.5265
31 instances of class 8 with average precision: 0.8429
53 instances of class 9 with average precision: 0.6354
49 instances of class / with average precision: 0.5796
59 instances of class A with average precision: 0.7761
45 instances of class B with average precision: 0.6863
92 instances of class C with average precision: 0.7461
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.6111
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.7450
3 instances of class N with average precision: 0.9167
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.6333
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.8360
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6759

Epoch 00002: saving model to ./snapshots/resnet50_csv_02.h5
Epoch 3/50
 92/280 [========>.....................] - ETA: 3:39 - loss: 1.1846 - regression_loss: 0.9500 - classification_loss: 0.2345keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
218/280 [======================>.......] - ETA: 1:12 - loss: 1.2131 - regression_loss: 0.9798 - classification_loss: 0.2333keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
279/280 [============================>.] - ETA: 1s - loss: 1.2006 - regression_loss: 0.9701 - classification_loss: 0.2305keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 345s 1s/step - loss: 1.2005 - regression_loss: 0.9698 - classification_loss: 0.2307 - val_loss: 1.5029 - val_regression_loss: 1.2087 - val_classification_loss: 0.2942
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7180
74 instances of class 1 with average precision: 0.6686
89 instances of class 2 with average precision: 0.6999
36 instances of class 3 with average precision: 0.6860
20 instances of class 4 with average precision: 0.5835
42 instances of class 5 with average precision: 0.6018
30 instances of class 6 with average precision: 0.4019
22 instances of class 7 with average precision: 0.4682
31 instances of class 8 with average precision: 0.8676
53 instances of class 9 with average precision: 0.6110
49 instances of class / with average precision: 0.6644
59 instances of class A with average precision: 0.7527
45 instances of class B with average precision: 0.6748
92 instances of class C with average precision: 0.7298
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.7039
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.7348
3 instances of class N with average precision: 1.0000
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.6954
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.8475
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6821

Epoch 00003: saving model to ./snapshots/resnet50_csv_03.h5
Epoch 4/50
220/280 [======================>.......] - ETA: 1:10 - loss: 1.1452 - regression_loss: 0.9440 - classification_loss: 0.2012keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 150 (shape (800, 800, 3)) contains the following invalid boxes: [[751. 297. 821. 366.]].
  annotations['bboxes'][invalid_indices, :]
279/280 [============================>.] - ETA: 1s - loss: 1.1349 - regression_loss: 0.9321 - classification_loss: 0.2028keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 345s 1s/step - loss: 1.1318 - regression_loss: 0.9297 - classification_loss: 0.2022 - val_loss: 1.5227 - val_regression_loss: 1.1620 - val_classification_loss: 0.3606
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7188
74 instances of class 1 with average precision: 0.6952
89 instances of class 2 with average precision: 0.6687
36 instances of class 3 with average precision: 0.6781
20 instances of class 4 with average precision: 0.6432
42 instances of class 5 with average precision: 0.5918
30 instances of class 6 with average precision: 0.4509
22 instances of class 7 with average precision: 0.4220
31 instances of class 8 with average precision: 0.8519
53 instances of class 9 with average precision: 0.5521
49 instances of class / with average precision: 0.6497
59 instances of class A with average precision: 0.7377
45 instances of class B with average precision: 0.6664
92 instances of class C with average precision: 0.7091
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.7292
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0000
74 instances of class M with average precision: 0.7239
3 instances of class N with average precision: 1.0000
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.6667
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.8400
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6733

Epoch 00004: saving model to ./snapshots/resnet50_csv_04.h5
Epoch 5/50
279/280 [============================>.] - ETA: 1s - loss: 1.1785 - regression_loss: 0.9651 - classification_loss: 0.2134keras_retinanet/bin/../../keras_retinanet/preprocessing/generator.py:170: UserWarning: Image with id 38 (shape (800, 800, 3)) contains the following invalid boxes: [[772. 216. 820. 304.]
 [737. 378. 810. 481.]
 [822. 376. 883. 478.]
 [781. 528. 835. 623.]].
  annotations['bboxes'][invalid_indices, :]
280/280 [==============================] - 345s 1s/step - loss: 1.1762 - regression_loss: 0.9634 - classification_loss: 0.2128 - val_loss: 1.4108 - val_regression_loss: 1.0918 - val_classification_loss: 0.3190
Running network: 100% (52 of 52) |#####################################################################################################################################| Elapsed Time: 0:00:18 Time:  0:00:18
Parsing annotations: 100% (52 of 52) |#################################################################################################################################| Elapsed Time: 0:00:00 Time:  0:00:00
164 instances of class 0 with average precision: 0.7345
74 instances of class 1 with average precision: 0.6676
89 instances of class 2 with average precision: 0.6817
36 instances of class 3 with average precision: 0.7037
20 instances of class 4 with average precision: 0.6397
42 instances of class 5 with average precision: 0.5561
30 instances of class 6 with average precision: 0.3901
22 instances of class 7 with average precision: 0.4690
31 instances of class 8 with average precision: 0.8562
53 instances of class 9 with average precision: 0.6250
49 instances of class / with average precision: 0.6482
59 instances of class A with average precision: 0.7361
45 instances of class B with average precision: 0.7216
92 instances of class C with average precision: 0.7065
1 instances of class D with average precision: 0.0000
1 instances of class E with average precision: 0.0000
10 instances of class F with average precision: 0.6949
0 instances of class G with average precision: 0.0000
0 instances of class H with average precision: 0.0000
0 instances of class I with average precision: 0.0000
0 instances of class J with average precision: 0.0000
0 instances of class K with average precision: 0.0000
2 instances of class L with average precision: 0.0185
74 instances of class M with average precision: 0.7537
3 instances of class N with average precision: 1.0000
2 instances of class O with average precision: 0.0000
1 instances of class P with average precision: 0.0000
0 instances of class Q with average precision: 0.0000
6 instances of class R with average precision: 0.6667
0 instances of class S with average precision: 0.0000
17 instances of class T with average precision: 0.8005
0 instances of class U with average precision: 0.0000
0 instances of class V with average precision: 0.0000
0 instances of class W with average precision: 0.0000
0 instances of class X with average precision: 0.0000
1 instances of class Y with average precision: 0.0000
0 instances of class Z with average precision: 0.0000
mAP: 0.6815

Epoch 00005: saving model to ./snapshots/resnet50_csv_05.h5
Traceback (most recent call last):
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/saving.py", line 382, in save_model
    _serialize_model(model, f, include_optimizer)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/saving.py", line 171, in _serialize_model
    optimizer_weights_group[name] = val
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/io_utils.py", line 223, in __setitem__
    dataset[:] = val
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/dataset.py", line 708, in __setitem__
    self.id.write(mspace, fspace, val, mtype, dxpl=self._dxpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5d.pyx", line 221, in h5py.h5d.DatasetID.write
  File "h5py/_proxy.pyx", line 132, in h5py._proxy.dset_rw
  File "h5py/_proxy.pyx", line 93, in h5py._proxy.H5PY_H5Dwrite
OSError: Can't write data (file write failed: time = Mon Jun  3 16:42:57 2019
, filename = './snapshots/resnet50_csv_05.h5', file descriptor = 27, errno = 28, error message = 'No space left on device', buf = 0x20d8b14a0, total write size = 98912, bytes this sub-write = 98912, bytes actually written = 18446744073709551615, offset = 152776704)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "keras_retinanet/bin/train.py", line 514, in <module>
    main()
  File "keras_retinanet/bin/train.py", line 509, in main
    validation_data=validation_generator
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/legacy/interfaces.py", line 91, in wrapper
    return func(*args, **kwargs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training.py", line 1418, in fit_generator
    initial_epoch=initial_epoch)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/training_generator.py", line 251, in fit_generator
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/callbacks.py", line 79, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "keras_retinanet/bin/../../keras_retinanet/callbacks/common.py", line 31, in on_epoch_end
    self.callback.on_epoch_end(epoch, logs=logs)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/callbacks.py", line 457, in on_epoch_end
    self.model.save(filepath, overwrite=True)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/network.py", line 1090, in save
    save_model(self, filepath, overwrite, include_optimizer)
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/engine/saving.py", line 385, in save_model
    f.close()
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/keras/utils/io_utils.py", line 330, in close
    self.data.file.flush()
  File "/home/abert/.virtualenvs/test/lib/python3.6/site-packages/h5py/_hl/files.py", line 433, in flush
    h5f.flush(self.id)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 143, in h5py.h5f.flush
RuntimeError: Unable to flush file's cached information (file write failed: time = Mon Jun  3 16:42:57 2019
, filename = './snapshots/resnet50_csv_05.h5', file descriptor = 27, errno = 28, error message = 'No space left on device', buf = 0x1e79db90, total write size = 2048, bytes this sub-write = 2048, bytes actually written = 18446744073709551615, offset = 4096)
Traceback (most recent call last):
  File "h5py/_objects.pyx", line 193, in h5py._objects.ObjectID.__dealloc__
RuntimeError: Problems closing file (file write failed: time = Mon Jun  3 16:42:57 2019
, filename = './snapshots/resnet50_csv_05.h5', file descriptor = 27, errno = 28, error message = 'No space left on device', buf = 0x1e79db90, total write size = 2048, bytes this sub-write = 2048, bytes actually written = 18446744073709551615, offset = 4096)
Exception ignored in: 'h5py._objects.ObjectID.__dealloc__'
Traceback (most recent call last):
  File "h5py/_objects.pyx", line 193, in h5py._objects.ObjectID.__dealloc__
RuntimeError: Problems closing file (file write failed: time = Mon Jun  3 16:42:57 2019
, filename = './snapshots/resnet50_csv_05.h5', file descriptor = 27, errno = 28, error message = 'No space left on device', buf = 0x1e79db90, total write size = 2048, bytes this sub-write = 2048, bytes actually written = 18446744073709551615, offset = 4096)
Segmentation fault (core dumped)
